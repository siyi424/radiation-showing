{"ast":null,"code":"/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nimport { __extends } from \"tslib\";\nimport BoundingRect from 'zrender/lib/core/BoundingRect.js';\nimport * as matrix from 'zrender/lib/core/matrix.js';\nimport * as graphic from '../../util/graphic.js';\nimport { createTextStyle } from '../../label/labelStyle.js';\nimport * as layout from '../../util/layout.js';\nimport TimelineView from './TimelineView.js';\nimport TimelineAxis from './TimelineAxis.js';\nimport { createSymbol, normalizeSymbolOffset, normalizeSymbolSize } from '../../util/symbol.js';\nimport * as numberUtil from '../../util/number.js';\nimport { merge, each, extend, isString, bind, defaults, retrieve2 } from 'zrender/lib/core/util.js';\nimport OrdinalScale from '../../scale/Ordinal.js';\nimport TimeScale from '../../scale/Time.js';\nimport IntervalScale from '../../scale/Interval.js';\nimport { parsePercent } from 'zrender/lib/contain/text.js';\nimport { makeInner } from '../../util/model.js';\nimport { getECData } from '../../util/innerStore.js';\nimport { enableHoverEmphasis } from '../../util/states.js';\nimport { createTooltipMarkup } from '../tooltip/tooltipMarkup.js';\nvar PI = Math.PI;\nvar labelDataIndexStore = makeInner();\n\nvar SliderTimelineView =\n/** @class */\nfunction (_super) {\n  __extends(SliderTimelineView, _super);\n\n  function SliderTimelineView() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.type = SliderTimelineView.type;\n    return _this;\n  }\n\n  SliderTimelineView.prototype.init = function (ecModel, api) {\n    this.api = api;\n  };\n  /**\n   * @override\n   */\n\n\n  SliderTimelineView.prototype.render = function (timelineModel, ecModel, api) {\n    this.model = timelineModel;\n    this.api = api;\n    this.ecModel = ecModel;\n    this.group.removeAll();\n\n    if (timelineModel.get('show', true)) {\n      var layoutInfo_1 = this._layout(timelineModel, api);\n\n      var mainGroup_1 = this._createGroup('_mainGroup');\n\n      var labelGroup = this._createGroup('_labelGroup');\n\n      var axis_1 = this._axis = this._createAxis(layoutInfo_1, timelineModel);\n\n      timelineModel.formatTooltip = function (dataIndex) {\n        var name = axis_1.scale.getLabel({\n          value: dataIndex\n        });\n        return createTooltipMarkup('nameValue', {\n          noName: true,\n          value: name\n        });\n      };\n\n      each(['AxisLine', 'AxisTick', 'Control', 'CurrentPointer'], function (name) {\n        this['_render' + name](layoutInfo_1, mainGroup_1, axis_1, timelineModel);\n      }, this);\n\n      this._renderAxisLabel(layoutInfo_1, labelGroup, axis_1, timelineModel);\n\n      this._position(layoutInfo_1, timelineModel);\n    }\n\n    this._doPlayStop();\n\n    this._updateTicksStatus();\n  };\n  /**\n   * @override\n   */\n\n\n  SliderTimelineView.prototype.remove = function () {\n    this._clearTimer();\n\n    this.group.removeAll();\n  };\n  /**\n   * @override\n   */\n\n\n  SliderTimelineView.prototype.dispose = function () {\n    this._clearTimer();\n  };\n\n  SliderTimelineView.prototype._layout = function (timelineModel, api) {\n    var labelPosOpt = timelineModel.get(['label', 'position']);\n    var orient = timelineModel.get('orient');\n    var viewRect = getViewRect(timelineModel, api);\n    var parsedLabelPos; // Auto label offset.\n\n    if (labelPosOpt == null || labelPosOpt === 'auto') {\n      parsedLabelPos = orient === 'horizontal' ? viewRect.y + viewRect.height / 2 < api.getHeight() / 2 ? '-' : '+' : viewRect.x + viewRect.width / 2 < api.getWidth() / 2 ? '+' : '-';\n    } else if (isString(labelPosOpt)) {\n      parsedLabelPos = {\n        horizontal: {\n          top: '-',\n          bottom: '+'\n        },\n        vertical: {\n          left: '-',\n          right: '+'\n        }\n      }[orient][labelPosOpt];\n    } else {\n      // is number\n      parsedLabelPos = labelPosOpt;\n    }\n\n    var labelAlignMap = {\n      horizontal: 'center',\n      vertical: parsedLabelPos >= 0 || parsedLabelPos === '+' ? 'left' : 'right'\n    };\n    var labelBaselineMap = {\n      horizontal: parsedLabelPos >= 0 || parsedLabelPos === '+' ? 'top' : 'bottom',\n      vertical: 'middle'\n    };\n    var rotationMap = {\n      horizontal: 0,\n      vertical: PI / 2\n    }; // Position\n\n    var mainLength = orient === 'vertical' ? viewRect.height : viewRect.width;\n    var controlModel = timelineModel.getModel('controlStyle');\n    var showControl = controlModel.get('show', true);\n    var controlSize = showControl ? controlModel.get('itemSize') : 0;\n    var controlGap = showControl ? controlModel.get('itemGap') : 0;\n    var sizePlusGap = controlSize + controlGap; // Special label rotate.\n\n    var labelRotation = timelineModel.get(['label', 'rotate']) || 0;\n    labelRotation = labelRotation * PI / 180; // To radian.\n\n    var playPosition;\n    var prevBtnPosition;\n    var nextBtnPosition;\n    var controlPosition = controlModel.get('position', true);\n    var showPlayBtn = showControl && controlModel.get('showPlayBtn', true);\n    var showPrevBtn = showControl && controlModel.get('showPrevBtn', true);\n    var showNextBtn = showControl && controlModel.get('showNextBtn', true);\n    var xLeft = 0;\n    var xRight = mainLength; // position[0] means left, position[1] means middle.\n\n    if (controlPosition === 'left' || controlPosition === 'bottom') {\n      showPlayBtn && (playPosition = [0, 0], xLeft += sizePlusGap);\n      showPrevBtn && (prevBtnPosition = [xLeft, 0], xLeft += sizePlusGap);\n      showNextBtn && (nextBtnPosition = [xRight - controlSize, 0], xRight -= sizePlusGap);\n    } else {\n      // 'top' 'right'\n      showPlayBtn && (playPosition = [xRight - controlSize, 0], xRight -= sizePlusGap);\n      showPrevBtn && (prevBtnPosition = [0, 0], xLeft += sizePlusGap);\n      showNextBtn && (nextBtnPosition = [xRight - controlSize, 0], xRight -= sizePlusGap);\n    }\n\n    var axisExtent = [xLeft, xRight];\n\n    if (timelineModel.get('inverse')) {\n      axisExtent.reverse();\n    }\n\n    return {\n      viewRect: viewRect,\n      mainLength: mainLength,\n      orient: orient,\n      rotation: rotationMap[orient],\n      labelRotation: labelRotation,\n      labelPosOpt: parsedLabelPos,\n      labelAlign: timelineModel.get(['label', 'align']) || labelAlignMap[orient],\n      labelBaseline: timelineModel.get(['label', 'verticalAlign']) || timelineModel.get(['label', 'baseline']) || labelBaselineMap[orient],\n      // Based on mainGroup.\n      playPosition: playPosition,\n      prevBtnPosition: prevBtnPosition,\n      nextBtnPosition: nextBtnPosition,\n      axisExtent: axisExtent,\n      controlSize: controlSize,\n      controlGap: controlGap\n    };\n  };\n\n  SliderTimelineView.prototype._position = function (layoutInfo, timelineModel) {\n    // Position is be called finally, because bounding rect is needed for\n    // adapt content to fill viewRect (auto adapt offset).\n    // Timeline may be not all in the viewRect when 'offset' is specified\n    // as a number, because it is more appropriate that label aligns at\n    // 'offset' but not the other edge defined by viewRect.\n    var mainGroup = this._mainGroup;\n    var labelGroup = this._labelGroup;\n    var viewRect = layoutInfo.viewRect;\n\n    if (layoutInfo.orient === 'vertical') {\n      // transform to horizontal, inverse rotate by left-top point.\n      var m = matrix.create();\n      var rotateOriginX = viewRect.x;\n      var rotateOriginY = viewRect.y + viewRect.height;\n      matrix.translate(m, m, [-rotateOriginX, -rotateOriginY]);\n      matrix.rotate(m, m, -PI / 2);\n      matrix.translate(m, m, [rotateOriginX, rotateOriginY]);\n      viewRect = viewRect.clone();\n      viewRect.applyTransform(m);\n    }\n\n    var viewBound = getBound(viewRect);\n    var mainBound = getBound(mainGroup.getBoundingRect());\n    var labelBound = getBound(labelGroup.getBoundingRect());\n    var mainPosition = [mainGroup.x, mainGroup.y];\n    var labelsPosition = [labelGroup.x, labelGroup.y];\n    labelsPosition[0] = mainPosition[0] = viewBound[0][0];\n    var labelPosOpt = layoutInfo.labelPosOpt;\n\n    if (labelPosOpt == null || isString(labelPosOpt)) {\n      // '+' or '-'\n      var mainBoundIdx = labelPosOpt === '+' ? 0 : 1;\n      toBound(mainPosition, mainBound, viewBound, 1, mainBoundIdx);\n      toBound(labelsPosition, labelBound, viewBound, 1, 1 - mainBoundIdx);\n    } else {\n      var mainBoundIdx = labelPosOpt >= 0 ? 0 : 1;\n      toBound(mainPosition, mainBound, viewBound, 1, mainBoundIdx);\n      labelsPosition[1] = mainPosition[1] + labelPosOpt;\n    }\n\n    mainGroup.setPosition(mainPosition);\n    labelGroup.setPosition(labelsPosition);\n    mainGroup.rotation = labelGroup.rotation = layoutInfo.rotation;\n    setOrigin(mainGroup);\n    setOrigin(labelGroup);\n\n    function setOrigin(targetGroup) {\n      targetGroup.originX = viewBound[0][0] - targetGroup.x;\n      targetGroup.originY = viewBound[1][0] - targetGroup.y;\n    }\n\n    function getBound(rect) {\n      // [[xmin, xmax], [ymin, ymax]]\n      return [[rect.x, rect.x + rect.width], [rect.y, rect.y + rect.height]];\n    }\n\n    function toBound(fromPos, from, to, dimIdx, boundIdx) {\n      fromPos[dimIdx] += to[dimIdx][boundIdx] - from[dimIdx][boundIdx];\n    }\n  };\n\n  SliderTimelineView.prototype._createAxis = function (layoutInfo, timelineModel) {\n    var data = timelineModel.getData();\n    var axisType = timelineModel.get('axisType');\n    var scale = createScaleByModel(timelineModel, axisType); // Customize scale. The `tickValue` is `dataIndex`.\n\n    scale.getTicks = function () {\n      return data.mapArray(['value'], function (value) {\n        return {\n          value: value\n        };\n      });\n    };\n\n    var dataExtent = data.getDataExtent('value');\n    scale.setExtent(dataExtent[0], dataExtent[1]);\n    scale.calcNiceTicks();\n    var axis = new TimelineAxis('value', scale, layoutInfo.axisExtent, axisType);\n    axis.model = timelineModel;\n    return axis;\n  };\n\n  SliderTimelineView.prototype._createGroup = function (key) {\n    var newGroup = this[key] = new graphic.Group();\n    this.group.add(newGroup);\n    return newGroup;\n  };\n\n  SliderTimelineView.prototype._renderAxisLine = function (layoutInfo, group, axis, timelineModel) {\n    var axisExtent = axis.getExtent();\n\n    if (!timelineModel.get(['lineStyle', 'show'])) {\n      return;\n    }\n\n    var line = new graphic.Line({\n      shape: {\n        x1: axisExtent[0],\n        y1: 0,\n        x2: axisExtent[1],\n        y2: 0\n      },\n      style: extend({\n        lineCap: 'round'\n      }, timelineModel.getModel('lineStyle').getLineStyle()),\n      silent: true,\n      z2: 1\n    });\n    group.add(line);\n    var progressLine = this._progressLine = new graphic.Line({\n      shape: {\n        x1: axisExtent[0],\n        x2: this._currentPointer ? this._currentPointer.x : axisExtent[0],\n        y1: 0,\n        y2: 0\n      },\n      style: defaults({\n        lineCap: 'round',\n        lineWidth: line.style.lineWidth\n      }, timelineModel.getModel(['progress', 'lineStyle']).getLineStyle()),\n      silent: true,\n      z2: 1\n    });\n    group.add(progressLine);\n  };\n\n  SliderTimelineView.prototype._renderAxisTick = function (layoutInfo, group, axis, timelineModel) {\n    var _this = this;\n\n    var data = timelineModel.getData(); // Show all ticks, despite ignoring strategy.\n\n    var ticks = axis.scale.getTicks();\n    this._tickSymbols = []; // The value is dataIndex, see the costomized scale.\n\n    each(ticks, function (tick) {\n      var tickCoord = axis.dataToCoord(tick.value);\n      var itemModel = data.getItemModel(tick.value);\n      var itemStyleModel = itemModel.getModel('itemStyle');\n      var hoverStyleModel = itemModel.getModel(['emphasis', 'itemStyle']);\n      var progressStyleModel = itemModel.getModel(['progress', 'itemStyle']);\n      var symbolOpt = {\n        x: tickCoord,\n        y: 0,\n        onclick: bind(_this._changeTimeline, _this, tick.value)\n      };\n      var el = giveSymbol(itemModel, itemStyleModel, group, symbolOpt);\n      el.ensureState('emphasis').style = hoverStyleModel.getItemStyle();\n      el.ensureState('progress').style = progressStyleModel.getItemStyle();\n      enableHoverEmphasis(el);\n      var ecData = getECData(el);\n\n      if (itemModel.get('tooltip')) {\n        ecData.dataIndex = tick.value;\n        ecData.dataModel = timelineModel;\n      } else {\n        ecData.dataIndex = ecData.dataModel = null;\n      }\n\n      _this._tickSymbols.push(el);\n    });\n  };\n\n  SliderTimelineView.prototype._renderAxisLabel = function (layoutInfo, group, axis, timelineModel) {\n    var _this = this;\n\n    var labelModel = axis.getLabelModel();\n\n    if (!labelModel.get('show')) {\n      return;\n    }\n\n    var data = timelineModel.getData();\n    var labels = axis.getViewLabels();\n    this._tickLabels = [];\n    each(labels, function (labelItem) {\n      // The tickValue is dataIndex, see the costomized scale.\n      var dataIndex = labelItem.tickValue;\n      var itemModel = data.getItemModel(dataIndex);\n      var normalLabelModel = itemModel.getModel('label');\n      var hoverLabelModel = itemModel.getModel(['emphasis', 'label']);\n      var progressLabelModel = itemModel.getModel(['progress', 'label']);\n      var tickCoord = axis.dataToCoord(labelItem.tickValue);\n      var textEl = new graphic.Text({\n        x: tickCoord,\n        y: 0,\n        rotation: layoutInfo.labelRotation - layoutInfo.rotation,\n        onclick: bind(_this._changeTimeline, _this, dataIndex),\n        silent: false,\n        style: createTextStyle(normalLabelModel, {\n          text: labelItem.formattedLabel,\n          align: layoutInfo.labelAlign,\n          verticalAlign: layoutInfo.labelBaseline\n        })\n      });\n      textEl.ensureState('emphasis').style = createTextStyle(hoverLabelModel);\n      textEl.ensureState('progress').style = createTextStyle(progressLabelModel);\n      group.add(textEl);\n      enableHoverEmphasis(textEl);\n      labelDataIndexStore(textEl).dataIndex = dataIndex;\n\n      _this._tickLabels.push(textEl);\n    });\n  };\n\n  SliderTimelineView.prototype._renderControl = function (layoutInfo, group, axis, timelineModel) {\n    var controlSize = layoutInfo.controlSize;\n    var rotation = layoutInfo.rotation;\n    var itemStyle = timelineModel.getModel('controlStyle').getItemStyle();\n    var hoverStyle = timelineModel.getModel(['emphasis', 'controlStyle']).getItemStyle();\n    var playState = timelineModel.getPlayState();\n    var inverse = timelineModel.get('inverse', true);\n    makeBtn(layoutInfo.nextBtnPosition, 'next', bind(this._changeTimeline, this, inverse ? '-' : '+'));\n    makeBtn(layoutInfo.prevBtnPosition, 'prev', bind(this._changeTimeline, this, inverse ? '+' : '-'));\n    makeBtn(layoutInfo.playPosition, playState ? 'stop' : 'play', bind(this._handlePlayClick, this, !playState), true);\n\n    function makeBtn(position, iconName, onclick, willRotate) {\n      if (!position) {\n        return;\n      }\n\n      var iconSize = parsePercent(retrieve2(timelineModel.get(['controlStyle', iconName + 'BtnSize']), controlSize), controlSize);\n      var rect = [0, -iconSize / 2, iconSize, iconSize];\n      var btn = makeControlIcon(timelineModel, iconName + 'Icon', rect, {\n        x: position[0],\n        y: position[1],\n        originX: controlSize / 2,\n        originY: 0,\n        rotation: willRotate ? -rotation : 0,\n        rectHover: true,\n        style: itemStyle,\n        onclick: onclick\n      });\n      btn.ensureState('emphasis').style = hoverStyle;\n      group.add(btn);\n      enableHoverEmphasis(btn);\n    }\n  };\n\n  SliderTimelineView.prototype._renderCurrentPointer = function (layoutInfo, group, axis, timelineModel) {\n    var data = timelineModel.getData();\n    var currentIndex = timelineModel.getCurrentIndex();\n    var pointerModel = data.getItemModel(currentIndex).getModel('checkpointStyle');\n    var me = this;\n    var callback = {\n      onCreate: function (pointer) {\n        pointer.draggable = true;\n        pointer.drift = bind(me._handlePointerDrag, me);\n        pointer.ondragend = bind(me._handlePointerDragend, me);\n        pointerMoveTo(pointer, me._progressLine, currentIndex, axis, timelineModel, true);\n      },\n      onUpdate: function (pointer) {\n        pointerMoveTo(pointer, me._progressLine, currentIndex, axis, timelineModel);\n      }\n    }; // Reuse when exists, for animation and drag.\n\n    this._currentPointer = giveSymbol(pointerModel, pointerModel, this._mainGroup, {}, this._currentPointer, callback);\n  };\n\n  SliderTimelineView.prototype._handlePlayClick = function (nextState) {\n    this._clearTimer();\n\n    this.api.dispatchAction({\n      type: 'timelinePlayChange',\n      playState: nextState,\n      from: this.uid\n    });\n  };\n\n  SliderTimelineView.prototype._handlePointerDrag = function (dx, dy, e) {\n    this._clearTimer();\n\n    this._pointerChangeTimeline([e.offsetX, e.offsetY]);\n  };\n\n  SliderTimelineView.prototype._handlePointerDragend = function (e) {\n    this._pointerChangeTimeline([e.offsetX, e.offsetY], true);\n  };\n\n  SliderTimelineView.prototype._pointerChangeTimeline = function (mousePos, trigger) {\n    var toCoord = this._toAxisCoord(mousePos)[0];\n\n    var axis = this._axis;\n    var axisExtent = numberUtil.asc(axis.getExtent().slice());\n    toCoord > axisExtent[1] && (toCoord = axisExtent[1]);\n    toCoord < axisExtent[0] && (toCoord = axisExtent[0]);\n    this._currentPointer.x = toCoord;\n\n    this._currentPointer.markRedraw();\n\n    this._progressLine.shape.x2 = toCoord;\n\n    this._progressLine.dirty();\n\n    var targetDataIndex = this._findNearestTick(toCoord);\n\n    var timelineModel = this.model;\n\n    if (trigger || targetDataIndex !== timelineModel.getCurrentIndex() && timelineModel.get('realtime')) {\n      this._changeTimeline(targetDataIndex);\n    }\n  };\n\n  SliderTimelineView.prototype._doPlayStop = function () {\n    var _this = this;\n\n    this._clearTimer();\n\n    if (this.model.getPlayState()) {\n      this._timer = setTimeout(function () {\n        // Do not cache\n        var timelineModel = _this.model;\n\n        _this._changeTimeline(timelineModel.getCurrentIndex() + (timelineModel.get('rewind', true) ? -1 : 1));\n      }, this.model.get('playInterval'));\n    }\n  };\n\n  SliderTimelineView.prototype._toAxisCoord = function (vertex) {\n    var trans = this._mainGroup.getLocalTransform();\n\n    return graphic.applyTransform(vertex, trans, true);\n  };\n\n  SliderTimelineView.prototype._findNearestTick = function (axisCoord) {\n    var data = this.model.getData();\n    var dist = Infinity;\n    var targetDataIndex;\n    var axis = this._axis;\n    data.each(['value'], function (value, dataIndex) {\n      var coord = axis.dataToCoord(value);\n      var d = Math.abs(coord - axisCoord);\n\n      if (d < dist) {\n        dist = d;\n        targetDataIndex = dataIndex;\n      }\n    });\n    return targetDataIndex;\n  };\n\n  SliderTimelineView.prototype._clearTimer = function () {\n    if (this._timer) {\n      clearTimeout(this._timer);\n      this._timer = null;\n    }\n  };\n\n  SliderTimelineView.prototype._changeTimeline = function (nextIndex) {\n    var currentIndex = this.model.getCurrentIndex();\n\n    if (nextIndex === '+') {\n      nextIndex = currentIndex + 1;\n    } else if (nextIndex === '-') {\n      nextIndex = currentIndex - 1;\n    }\n\n    this.api.dispatchAction({\n      type: 'timelineChange',\n      currentIndex: nextIndex,\n      from: this.uid\n    });\n  };\n\n  SliderTimelineView.prototype._updateTicksStatus = function () {\n    var currentIndex = this.model.getCurrentIndex();\n    var tickSymbols = this._tickSymbols;\n    var tickLabels = this._tickLabels;\n\n    if (tickSymbols) {\n      for (var i = 0; i < tickSymbols.length; i++) {\n        tickSymbols && tickSymbols[i] && tickSymbols[i].toggleState('progress', i < currentIndex);\n      }\n    }\n\n    if (tickLabels) {\n      for (var i = 0; i < tickLabels.length; i++) {\n        tickLabels && tickLabels[i] && tickLabels[i].toggleState('progress', labelDataIndexStore(tickLabels[i]).dataIndex <= currentIndex);\n      }\n    }\n  };\n\n  SliderTimelineView.type = 'timeline.slider';\n  return SliderTimelineView;\n}(TimelineView);\n\nfunction createScaleByModel(model, axisType) {\n  axisType = axisType || model.get('type');\n\n  if (axisType) {\n    switch (axisType) {\n      // Buildin scale\n      case 'category':\n        return new OrdinalScale({\n          ordinalMeta: model.getCategories(),\n          extent: [Infinity, -Infinity]\n        });\n\n      case 'time':\n        return new TimeScale({\n          locale: model.ecModel.getLocaleModel(),\n          useUTC: model.ecModel.get('useUTC')\n        });\n\n      default:\n        // default to be value\n        return new IntervalScale();\n    }\n  }\n}\n\nfunction getViewRect(model, api) {\n  return layout.getLayoutRect(model.getBoxLayoutParams(), {\n    width: api.getWidth(),\n    height: api.getHeight()\n  }, model.get('padding'));\n}\n\nfunction makeControlIcon(timelineModel, objPath, rect, opts) {\n  var style = opts.style;\n  var icon = graphic.createIcon(timelineModel.get(['controlStyle', objPath]), opts || {}, new BoundingRect(rect[0], rect[1], rect[2], rect[3])); // TODO createIcon won't use style in opt.\n\n  if (style) {\n    icon.setStyle(style);\n  }\n\n  return icon;\n}\n/**\n * Create symbol or update symbol\n * opt: basic position and event handlers\n */\n\n\nfunction giveSymbol(hostModel, itemStyleModel, group, opt, symbol, callback) {\n  var color = itemStyleModel.get('color');\n\n  if (!symbol) {\n    var symbolType = hostModel.get('symbol');\n    symbol = createSymbol(symbolType, -1, -1, 2, 2, color);\n    symbol.setStyle('strokeNoScale', true);\n    group.add(symbol);\n    callback && callback.onCreate(symbol);\n  } else {\n    symbol.setColor(color);\n    group.add(symbol); // Group may be new, also need to add.\n\n    callback && callback.onUpdate(symbol);\n  } // Style\n\n\n  var itemStyle = itemStyleModel.getItemStyle(['color']);\n  symbol.setStyle(itemStyle); // Transform and events.\n\n  opt = merge({\n    rectHover: true,\n    z2: 100\n  }, opt, true);\n  var symbolSize = normalizeSymbolSize(hostModel.get('symbolSize'));\n  opt.scaleX = symbolSize[0] / 2;\n  opt.scaleY = symbolSize[1] / 2;\n  var symbolOffset = normalizeSymbolOffset(hostModel.get('symbolOffset'), symbolSize);\n\n  if (symbolOffset) {\n    opt.x = (opt.x || 0) + symbolOffset[0];\n    opt.y = (opt.y || 0) + symbolOffset[1];\n  }\n\n  var symbolRotate = hostModel.get('symbolRotate');\n  opt.rotation = (symbolRotate || 0) * Math.PI / 180 || 0;\n  symbol.attr(opt); // FIXME\n  // (1) When symbol.style.strokeNoScale is true and updateTransform is not performed,\n  // getBoundingRect will return wrong result.\n  // (This is supposed to be resolved in zrender, but it is a little difficult to\n  // leverage performance and auto updateTransform)\n  // (2) All of ancesters of symbol do not scale, so we can just updateTransform symbol.\n\n  symbol.updateTransform();\n  return symbol;\n}\n\nfunction pointerMoveTo(pointer, progressLine, dataIndex, axis, timelineModel, noAnimation) {\n  if (pointer.dragging) {\n    return;\n  }\n\n  var pointerModel = timelineModel.getModel('checkpointStyle');\n  var toCoord = axis.dataToCoord(timelineModel.getData().get('value', dataIndex));\n\n  if (noAnimation || !pointerModel.get('animation', true)) {\n    pointer.attr({\n      x: toCoord,\n      y: 0\n    });\n    progressLine && progressLine.attr({\n      shape: {\n        x2: toCoord\n      }\n    });\n  } else {\n    var animationCfg = {\n      duration: pointerModel.get('animationDuration', true),\n      easing: pointerModel.get('animationEasing', true)\n    };\n    pointer.stopAnimation(null, true);\n    pointer.animateTo({\n      x: toCoord,\n      y: 0\n    }, animationCfg);\n    progressLine && progressLine.animateTo({\n      shape: {\n        x2: toCoord\n      }\n    }, animationCfg);\n  }\n}\n\nexport default SliderTimelineView;","map":{"version":3,"names":["__extends","BoundingRect","matrix","graphic","createTextStyle","layout","TimelineView","TimelineAxis","createSymbol","normalizeSymbolOffset","normalizeSymbolSize","numberUtil","merge","each","extend","isString","bind","defaults","retrieve2","OrdinalScale","TimeScale","IntervalScale","parsePercent","makeInner","getECData","enableHoverEmphasis","createTooltipMarkup","PI","Math","labelDataIndexStore","SliderTimelineView","_super","_this","apply","arguments","type","prototype","init","ecModel","api","render","timelineModel","model","group","removeAll","get","layoutInfo_1","_layout","mainGroup_1","_createGroup","labelGroup","axis_1","_axis","_createAxis","formatTooltip","dataIndex","name","scale","getLabel","value","noName","_renderAxisLabel","_position","_doPlayStop","_updateTicksStatus","remove","_clearTimer","dispose","labelPosOpt","orient","viewRect","getViewRect","parsedLabelPos","y","height","getHeight","x","width","getWidth","horizontal","top","bottom","vertical","left","right","labelAlignMap","labelBaselineMap","rotationMap","mainLength","controlModel","getModel","showControl","controlSize","controlGap","sizePlusGap","labelRotation","playPosition","prevBtnPosition","nextBtnPosition","controlPosition","showPlayBtn","showPrevBtn","showNextBtn","xLeft","xRight","axisExtent","reverse","rotation","labelAlign","labelBaseline","layoutInfo","mainGroup","_mainGroup","_labelGroup","m","create","rotateOriginX","rotateOriginY","translate","rotate","clone","applyTransform","viewBound","getBound","mainBound","getBoundingRect","labelBound","mainPosition","labelsPosition","mainBoundIdx","toBound","setPosition","setOrigin","targetGroup","originX","originY","rect","fromPos","from","to","dimIdx","boundIdx","data","getData","axisType","createScaleByModel","getTicks","mapArray","dataExtent","getDataExtent","setExtent","calcNiceTicks","axis","key","newGroup","Group","add","_renderAxisLine","getExtent","line","Line","shape","x1","y1","x2","y2","style","lineCap","getLineStyle","silent","z2","progressLine","_progressLine","_currentPointer","lineWidth","_renderAxisTick","ticks","_tickSymbols","tick","tickCoord","dataToCoord","itemModel","getItemModel","itemStyleModel","hoverStyleModel","progressStyleModel","symbolOpt","onclick","_changeTimeline","el","giveSymbol","ensureState","getItemStyle","ecData","dataModel","push","labelModel","getLabelModel","labels","getViewLabels","_tickLabels","labelItem","tickValue","normalLabelModel","hoverLabelModel","progressLabelModel","textEl","Text","text","formattedLabel","align","verticalAlign","_renderControl","itemStyle","hoverStyle","playState","getPlayState","inverse","makeBtn","_handlePlayClick","position","iconName","willRotate","iconSize","btn","makeControlIcon","rectHover","_renderCurrentPointer","currentIndex","getCurrentIndex","pointerModel","me","callback","onCreate","pointer","draggable","drift","_handlePointerDrag","ondragend","_handlePointerDragend","pointerMoveTo","onUpdate","nextState","dispatchAction","uid","dx","dy","e","_pointerChangeTimeline","offsetX","offsetY","mousePos","trigger","toCoord","_toAxisCoord","asc","slice","markRedraw","dirty","targetDataIndex","_findNearestTick","_timer","setTimeout","vertex","trans","getLocalTransform","axisCoord","dist","Infinity","coord","d","abs","clearTimeout","nextIndex","tickSymbols","tickLabels","i","length","toggleState","ordinalMeta","getCategories","extent","locale","getLocaleModel","useUTC","getLayoutRect","getBoxLayoutParams","objPath","opts","icon","createIcon","setStyle","hostModel","opt","symbol","color","symbolType","setColor","symbolSize","scaleX","scaleY","symbolOffset","symbolRotate","attr","updateTransform","noAnimation","dragging","animationCfg","duration","easing","stopAnimation","animateTo"],"sources":["/home/siyi/Projects/radi-demo/radi-showing/node_modules/echarts/lib/component/timeline/SliderTimelineView.js"],"sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nimport { __extends } from \"tslib\";\nimport BoundingRect from 'zrender/lib/core/BoundingRect.js';\nimport * as matrix from 'zrender/lib/core/matrix.js';\nimport * as graphic from '../../util/graphic.js';\nimport { createTextStyle } from '../../label/labelStyle.js';\nimport * as layout from '../../util/layout.js';\nimport TimelineView from './TimelineView.js';\nimport TimelineAxis from './TimelineAxis.js';\nimport { createSymbol, normalizeSymbolOffset, normalizeSymbolSize } from '../../util/symbol.js';\nimport * as numberUtil from '../../util/number.js';\nimport { merge, each, extend, isString, bind, defaults, retrieve2 } from 'zrender/lib/core/util.js';\nimport OrdinalScale from '../../scale/Ordinal.js';\nimport TimeScale from '../../scale/Time.js';\nimport IntervalScale from '../../scale/Interval.js';\nimport { parsePercent } from 'zrender/lib/contain/text.js';\nimport { makeInner } from '../../util/model.js';\nimport { getECData } from '../../util/innerStore.js';\nimport { enableHoverEmphasis } from '../../util/states.js';\nimport { createTooltipMarkup } from '../tooltip/tooltipMarkup.js';\nvar PI = Math.PI;\nvar labelDataIndexStore = makeInner();\n\nvar SliderTimelineView =\n/** @class */\nfunction (_super) {\n  __extends(SliderTimelineView, _super);\n\n  function SliderTimelineView() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.type = SliderTimelineView.type;\n    return _this;\n  }\n\n  SliderTimelineView.prototype.init = function (ecModel, api) {\n    this.api = api;\n  };\n  /**\n   * @override\n   */\n\n\n  SliderTimelineView.prototype.render = function (timelineModel, ecModel, api) {\n    this.model = timelineModel;\n    this.api = api;\n    this.ecModel = ecModel;\n    this.group.removeAll();\n\n    if (timelineModel.get('show', true)) {\n      var layoutInfo_1 = this._layout(timelineModel, api);\n\n      var mainGroup_1 = this._createGroup('_mainGroup');\n\n      var labelGroup = this._createGroup('_labelGroup');\n\n      var axis_1 = this._axis = this._createAxis(layoutInfo_1, timelineModel);\n\n      timelineModel.formatTooltip = function (dataIndex) {\n        var name = axis_1.scale.getLabel({\n          value: dataIndex\n        });\n        return createTooltipMarkup('nameValue', {\n          noName: true,\n          value: name\n        });\n      };\n\n      each(['AxisLine', 'AxisTick', 'Control', 'CurrentPointer'], function (name) {\n        this['_render' + name](layoutInfo_1, mainGroup_1, axis_1, timelineModel);\n      }, this);\n\n      this._renderAxisLabel(layoutInfo_1, labelGroup, axis_1, timelineModel);\n\n      this._position(layoutInfo_1, timelineModel);\n    }\n\n    this._doPlayStop();\n\n    this._updateTicksStatus();\n  };\n  /**\n   * @override\n   */\n\n\n  SliderTimelineView.prototype.remove = function () {\n    this._clearTimer();\n\n    this.group.removeAll();\n  };\n  /**\n   * @override\n   */\n\n\n  SliderTimelineView.prototype.dispose = function () {\n    this._clearTimer();\n  };\n\n  SliderTimelineView.prototype._layout = function (timelineModel, api) {\n    var labelPosOpt = timelineModel.get(['label', 'position']);\n    var orient = timelineModel.get('orient');\n    var viewRect = getViewRect(timelineModel, api);\n    var parsedLabelPos; // Auto label offset.\n\n    if (labelPosOpt == null || labelPosOpt === 'auto') {\n      parsedLabelPos = orient === 'horizontal' ? viewRect.y + viewRect.height / 2 < api.getHeight() / 2 ? '-' : '+' : viewRect.x + viewRect.width / 2 < api.getWidth() / 2 ? '+' : '-';\n    } else if (isString(labelPosOpt)) {\n      parsedLabelPos = {\n        horizontal: {\n          top: '-',\n          bottom: '+'\n        },\n        vertical: {\n          left: '-',\n          right: '+'\n        }\n      }[orient][labelPosOpt];\n    } else {\n      // is number\n      parsedLabelPos = labelPosOpt;\n    }\n\n    var labelAlignMap = {\n      horizontal: 'center',\n      vertical: parsedLabelPos >= 0 || parsedLabelPos === '+' ? 'left' : 'right'\n    };\n    var labelBaselineMap = {\n      horizontal: parsedLabelPos >= 0 || parsedLabelPos === '+' ? 'top' : 'bottom',\n      vertical: 'middle'\n    };\n    var rotationMap = {\n      horizontal: 0,\n      vertical: PI / 2\n    }; // Position\n\n    var mainLength = orient === 'vertical' ? viewRect.height : viewRect.width;\n    var controlModel = timelineModel.getModel('controlStyle');\n    var showControl = controlModel.get('show', true);\n    var controlSize = showControl ? controlModel.get('itemSize') : 0;\n    var controlGap = showControl ? controlModel.get('itemGap') : 0;\n    var sizePlusGap = controlSize + controlGap; // Special label rotate.\n\n    var labelRotation = timelineModel.get(['label', 'rotate']) || 0;\n    labelRotation = labelRotation * PI / 180; // To radian.\n\n    var playPosition;\n    var prevBtnPosition;\n    var nextBtnPosition;\n    var controlPosition = controlModel.get('position', true);\n    var showPlayBtn = showControl && controlModel.get('showPlayBtn', true);\n    var showPrevBtn = showControl && controlModel.get('showPrevBtn', true);\n    var showNextBtn = showControl && controlModel.get('showNextBtn', true);\n    var xLeft = 0;\n    var xRight = mainLength; // position[0] means left, position[1] means middle.\n\n    if (controlPosition === 'left' || controlPosition === 'bottom') {\n      showPlayBtn && (playPosition = [0, 0], xLeft += sizePlusGap);\n      showPrevBtn && (prevBtnPosition = [xLeft, 0], xLeft += sizePlusGap);\n      showNextBtn && (nextBtnPosition = [xRight - controlSize, 0], xRight -= sizePlusGap);\n    } else {\n      // 'top' 'right'\n      showPlayBtn && (playPosition = [xRight - controlSize, 0], xRight -= sizePlusGap);\n      showPrevBtn && (prevBtnPosition = [0, 0], xLeft += sizePlusGap);\n      showNextBtn && (nextBtnPosition = [xRight - controlSize, 0], xRight -= sizePlusGap);\n    }\n\n    var axisExtent = [xLeft, xRight];\n\n    if (timelineModel.get('inverse')) {\n      axisExtent.reverse();\n    }\n\n    return {\n      viewRect: viewRect,\n      mainLength: mainLength,\n      orient: orient,\n      rotation: rotationMap[orient],\n      labelRotation: labelRotation,\n      labelPosOpt: parsedLabelPos,\n      labelAlign: timelineModel.get(['label', 'align']) || labelAlignMap[orient],\n      labelBaseline: timelineModel.get(['label', 'verticalAlign']) || timelineModel.get(['label', 'baseline']) || labelBaselineMap[orient],\n      // Based on mainGroup.\n      playPosition: playPosition,\n      prevBtnPosition: prevBtnPosition,\n      nextBtnPosition: nextBtnPosition,\n      axisExtent: axisExtent,\n      controlSize: controlSize,\n      controlGap: controlGap\n    };\n  };\n\n  SliderTimelineView.prototype._position = function (layoutInfo, timelineModel) {\n    // Position is be called finally, because bounding rect is needed for\n    // adapt content to fill viewRect (auto adapt offset).\n    // Timeline may be not all in the viewRect when 'offset' is specified\n    // as a number, because it is more appropriate that label aligns at\n    // 'offset' but not the other edge defined by viewRect.\n    var mainGroup = this._mainGroup;\n    var labelGroup = this._labelGroup;\n    var viewRect = layoutInfo.viewRect;\n\n    if (layoutInfo.orient === 'vertical') {\n      // transform to horizontal, inverse rotate by left-top point.\n      var m = matrix.create();\n      var rotateOriginX = viewRect.x;\n      var rotateOriginY = viewRect.y + viewRect.height;\n      matrix.translate(m, m, [-rotateOriginX, -rotateOriginY]);\n      matrix.rotate(m, m, -PI / 2);\n      matrix.translate(m, m, [rotateOriginX, rotateOriginY]);\n      viewRect = viewRect.clone();\n      viewRect.applyTransform(m);\n    }\n\n    var viewBound = getBound(viewRect);\n    var mainBound = getBound(mainGroup.getBoundingRect());\n    var labelBound = getBound(labelGroup.getBoundingRect());\n    var mainPosition = [mainGroup.x, mainGroup.y];\n    var labelsPosition = [labelGroup.x, labelGroup.y];\n    labelsPosition[0] = mainPosition[0] = viewBound[0][0];\n    var labelPosOpt = layoutInfo.labelPosOpt;\n\n    if (labelPosOpt == null || isString(labelPosOpt)) {\n      // '+' or '-'\n      var mainBoundIdx = labelPosOpt === '+' ? 0 : 1;\n      toBound(mainPosition, mainBound, viewBound, 1, mainBoundIdx);\n      toBound(labelsPosition, labelBound, viewBound, 1, 1 - mainBoundIdx);\n    } else {\n      var mainBoundIdx = labelPosOpt >= 0 ? 0 : 1;\n      toBound(mainPosition, mainBound, viewBound, 1, mainBoundIdx);\n      labelsPosition[1] = mainPosition[1] + labelPosOpt;\n    }\n\n    mainGroup.setPosition(mainPosition);\n    labelGroup.setPosition(labelsPosition);\n    mainGroup.rotation = labelGroup.rotation = layoutInfo.rotation;\n    setOrigin(mainGroup);\n    setOrigin(labelGroup);\n\n    function setOrigin(targetGroup) {\n      targetGroup.originX = viewBound[0][0] - targetGroup.x;\n      targetGroup.originY = viewBound[1][0] - targetGroup.y;\n    }\n\n    function getBound(rect) {\n      // [[xmin, xmax], [ymin, ymax]]\n      return [[rect.x, rect.x + rect.width], [rect.y, rect.y + rect.height]];\n    }\n\n    function toBound(fromPos, from, to, dimIdx, boundIdx) {\n      fromPos[dimIdx] += to[dimIdx][boundIdx] - from[dimIdx][boundIdx];\n    }\n  };\n\n  SliderTimelineView.prototype._createAxis = function (layoutInfo, timelineModel) {\n    var data = timelineModel.getData();\n    var axisType = timelineModel.get('axisType');\n    var scale = createScaleByModel(timelineModel, axisType); // Customize scale. The `tickValue` is `dataIndex`.\n\n    scale.getTicks = function () {\n      return data.mapArray(['value'], function (value) {\n        return {\n          value: value\n        };\n      });\n    };\n\n    var dataExtent = data.getDataExtent('value');\n    scale.setExtent(dataExtent[0], dataExtent[1]);\n    scale.calcNiceTicks();\n    var axis = new TimelineAxis('value', scale, layoutInfo.axisExtent, axisType);\n    axis.model = timelineModel;\n    return axis;\n  };\n\n  SliderTimelineView.prototype._createGroup = function (key) {\n    var newGroup = this[key] = new graphic.Group();\n    this.group.add(newGroup);\n    return newGroup;\n  };\n\n  SliderTimelineView.prototype._renderAxisLine = function (layoutInfo, group, axis, timelineModel) {\n    var axisExtent = axis.getExtent();\n\n    if (!timelineModel.get(['lineStyle', 'show'])) {\n      return;\n    }\n\n    var line = new graphic.Line({\n      shape: {\n        x1: axisExtent[0],\n        y1: 0,\n        x2: axisExtent[1],\n        y2: 0\n      },\n      style: extend({\n        lineCap: 'round'\n      }, timelineModel.getModel('lineStyle').getLineStyle()),\n      silent: true,\n      z2: 1\n    });\n    group.add(line);\n    var progressLine = this._progressLine = new graphic.Line({\n      shape: {\n        x1: axisExtent[0],\n        x2: this._currentPointer ? this._currentPointer.x : axisExtent[0],\n        y1: 0,\n        y2: 0\n      },\n      style: defaults({\n        lineCap: 'round',\n        lineWidth: line.style.lineWidth\n      }, timelineModel.getModel(['progress', 'lineStyle']).getLineStyle()),\n      silent: true,\n      z2: 1\n    });\n    group.add(progressLine);\n  };\n\n  SliderTimelineView.prototype._renderAxisTick = function (layoutInfo, group, axis, timelineModel) {\n    var _this = this;\n\n    var data = timelineModel.getData(); // Show all ticks, despite ignoring strategy.\n\n    var ticks = axis.scale.getTicks();\n    this._tickSymbols = []; // The value is dataIndex, see the costomized scale.\n\n    each(ticks, function (tick) {\n      var tickCoord = axis.dataToCoord(tick.value);\n      var itemModel = data.getItemModel(tick.value);\n      var itemStyleModel = itemModel.getModel('itemStyle');\n      var hoverStyleModel = itemModel.getModel(['emphasis', 'itemStyle']);\n      var progressStyleModel = itemModel.getModel(['progress', 'itemStyle']);\n      var symbolOpt = {\n        x: tickCoord,\n        y: 0,\n        onclick: bind(_this._changeTimeline, _this, tick.value)\n      };\n      var el = giveSymbol(itemModel, itemStyleModel, group, symbolOpt);\n      el.ensureState('emphasis').style = hoverStyleModel.getItemStyle();\n      el.ensureState('progress').style = progressStyleModel.getItemStyle();\n      enableHoverEmphasis(el);\n      var ecData = getECData(el);\n\n      if (itemModel.get('tooltip')) {\n        ecData.dataIndex = tick.value;\n        ecData.dataModel = timelineModel;\n      } else {\n        ecData.dataIndex = ecData.dataModel = null;\n      }\n\n      _this._tickSymbols.push(el);\n    });\n  };\n\n  SliderTimelineView.prototype._renderAxisLabel = function (layoutInfo, group, axis, timelineModel) {\n    var _this = this;\n\n    var labelModel = axis.getLabelModel();\n\n    if (!labelModel.get('show')) {\n      return;\n    }\n\n    var data = timelineModel.getData();\n    var labels = axis.getViewLabels();\n    this._tickLabels = [];\n    each(labels, function (labelItem) {\n      // The tickValue is dataIndex, see the costomized scale.\n      var dataIndex = labelItem.tickValue;\n      var itemModel = data.getItemModel(dataIndex);\n      var normalLabelModel = itemModel.getModel('label');\n      var hoverLabelModel = itemModel.getModel(['emphasis', 'label']);\n      var progressLabelModel = itemModel.getModel(['progress', 'label']);\n      var tickCoord = axis.dataToCoord(labelItem.tickValue);\n      var textEl = new graphic.Text({\n        x: tickCoord,\n        y: 0,\n        rotation: layoutInfo.labelRotation - layoutInfo.rotation,\n        onclick: bind(_this._changeTimeline, _this, dataIndex),\n        silent: false,\n        style: createTextStyle(normalLabelModel, {\n          text: labelItem.formattedLabel,\n          align: layoutInfo.labelAlign,\n          verticalAlign: layoutInfo.labelBaseline\n        })\n      });\n      textEl.ensureState('emphasis').style = createTextStyle(hoverLabelModel);\n      textEl.ensureState('progress').style = createTextStyle(progressLabelModel);\n      group.add(textEl);\n      enableHoverEmphasis(textEl);\n      labelDataIndexStore(textEl).dataIndex = dataIndex;\n\n      _this._tickLabels.push(textEl);\n    });\n  };\n\n  SliderTimelineView.prototype._renderControl = function (layoutInfo, group, axis, timelineModel) {\n    var controlSize = layoutInfo.controlSize;\n    var rotation = layoutInfo.rotation;\n    var itemStyle = timelineModel.getModel('controlStyle').getItemStyle();\n    var hoverStyle = timelineModel.getModel(['emphasis', 'controlStyle']).getItemStyle();\n    var playState = timelineModel.getPlayState();\n    var inverse = timelineModel.get('inverse', true);\n    makeBtn(layoutInfo.nextBtnPosition, 'next', bind(this._changeTimeline, this, inverse ? '-' : '+'));\n    makeBtn(layoutInfo.prevBtnPosition, 'prev', bind(this._changeTimeline, this, inverse ? '+' : '-'));\n    makeBtn(layoutInfo.playPosition, playState ? 'stop' : 'play', bind(this._handlePlayClick, this, !playState), true);\n\n    function makeBtn(position, iconName, onclick, willRotate) {\n      if (!position) {\n        return;\n      }\n\n      var iconSize = parsePercent(retrieve2(timelineModel.get(['controlStyle', iconName + 'BtnSize']), controlSize), controlSize);\n      var rect = [0, -iconSize / 2, iconSize, iconSize];\n      var btn = makeControlIcon(timelineModel, iconName + 'Icon', rect, {\n        x: position[0],\n        y: position[1],\n        originX: controlSize / 2,\n        originY: 0,\n        rotation: willRotate ? -rotation : 0,\n        rectHover: true,\n        style: itemStyle,\n        onclick: onclick\n      });\n      btn.ensureState('emphasis').style = hoverStyle;\n      group.add(btn);\n      enableHoverEmphasis(btn);\n    }\n  };\n\n  SliderTimelineView.prototype._renderCurrentPointer = function (layoutInfo, group, axis, timelineModel) {\n    var data = timelineModel.getData();\n    var currentIndex = timelineModel.getCurrentIndex();\n    var pointerModel = data.getItemModel(currentIndex).getModel('checkpointStyle');\n    var me = this;\n    var callback = {\n      onCreate: function (pointer) {\n        pointer.draggable = true;\n        pointer.drift = bind(me._handlePointerDrag, me);\n        pointer.ondragend = bind(me._handlePointerDragend, me);\n        pointerMoveTo(pointer, me._progressLine, currentIndex, axis, timelineModel, true);\n      },\n      onUpdate: function (pointer) {\n        pointerMoveTo(pointer, me._progressLine, currentIndex, axis, timelineModel);\n      }\n    }; // Reuse when exists, for animation and drag.\n\n    this._currentPointer = giveSymbol(pointerModel, pointerModel, this._mainGroup, {}, this._currentPointer, callback);\n  };\n\n  SliderTimelineView.prototype._handlePlayClick = function (nextState) {\n    this._clearTimer();\n\n    this.api.dispatchAction({\n      type: 'timelinePlayChange',\n      playState: nextState,\n      from: this.uid\n    });\n  };\n\n  SliderTimelineView.prototype._handlePointerDrag = function (dx, dy, e) {\n    this._clearTimer();\n\n    this._pointerChangeTimeline([e.offsetX, e.offsetY]);\n  };\n\n  SliderTimelineView.prototype._handlePointerDragend = function (e) {\n    this._pointerChangeTimeline([e.offsetX, e.offsetY], true);\n  };\n\n  SliderTimelineView.prototype._pointerChangeTimeline = function (mousePos, trigger) {\n    var toCoord = this._toAxisCoord(mousePos)[0];\n\n    var axis = this._axis;\n    var axisExtent = numberUtil.asc(axis.getExtent().slice());\n    toCoord > axisExtent[1] && (toCoord = axisExtent[1]);\n    toCoord < axisExtent[0] && (toCoord = axisExtent[0]);\n    this._currentPointer.x = toCoord;\n\n    this._currentPointer.markRedraw();\n\n    this._progressLine.shape.x2 = toCoord;\n\n    this._progressLine.dirty();\n\n    var targetDataIndex = this._findNearestTick(toCoord);\n\n    var timelineModel = this.model;\n\n    if (trigger || targetDataIndex !== timelineModel.getCurrentIndex() && timelineModel.get('realtime')) {\n      this._changeTimeline(targetDataIndex);\n    }\n  };\n\n  SliderTimelineView.prototype._doPlayStop = function () {\n    var _this = this;\n\n    this._clearTimer();\n\n    if (this.model.getPlayState()) {\n      this._timer = setTimeout(function () {\n        // Do not cache\n        var timelineModel = _this.model;\n\n        _this._changeTimeline(timelineModel.getCurrentIndex() + (timelineModel.get('rewind', true) ? -1 : 1));\n      }, this.model.get('playInterval'));\n    }\n  };\n\n  SliderTimelineView.prototype._toAxisCoord = function (vertex) {\n    var trans = this._mainGroup.getLocalTransform();\n\n    return graphic.applyTransform(vertex, trans, true);\n  };\n\n  SliderTimelineView.prototype._findNearestTick = function (axisCoord) {\n    var data = this.model.getData();\n    var dist = Infinity;\n    var targetDataIndex;\n    var axis = this._axis;\n    data.each(['value'], function (value, dataIndex) {\n      var coord = axis.dataToCoord(value);\n      var d = Math.abs(coord - axisCoord);\n\n      if (d < dist) {\n        dist = d;\n        targetDataIndex = dataIndex;\n      }\n    });\n    return targetDataIndex;\n  };\n\n  SliderTimelineView.prototype._clearTimer = function () {\n    if (this._timer) {\n      clearTimeout(this._timer);\n      this._timer = null;\n    }\n  };\n\n  SliderTimelineView.prototype._changeTimeline = function (nextIndex) {\n    var currentIndex = this.model.getCurrentIndex();\n\n    if (nextIndex === '+') {\n      nextIndex = currentIndex + 1;\n    } else if (nextIndex === '-') {\n      nextIndex = currentIndex - 1;\n    }\n\n    this.api.dispatchAction({\n      type: 'timelineChange',\n      currentIndex: nextIndex,\n      from: this.uid\n    });\n  };\n\n  SliderTimelineView.prototype._updateTicksStatus = function () {\n    var currentIndex = this.model.getCurrentIndex();\n    var tickSymbols = this._tickSymbols;\n    var tickLabels = this._tickLabels;\n\n    if (tickSymbols) {\n      for (var i = 0; i < tickSymbols.length; i++) {\n        tickSymbols && tickSymbols[i] && tickSymbols[i].toggleState('progress', i < currentIndex);\n      }\n    }\n\n    if (tickLabels) {\n      for (var i = 0; i < tickLabels.length; i++) {\n        tickLabels && tickLabels[i] && tickLabels[i].toggleState('progress', labelDataIndexStore(tickLabels[i]).dataIndex <= currentIndex);\n      }\n    }\n  };\n\n  SliderTimelineView.type = 'timeline.slider';\n  return SliderTimelineView;\n}(TimelineView);\n\nfunction createScaleByModel(model, axisType) {\n  axisType = axisType || model.get('type');\n\n  if (axisType) {\n    switch (axisType) {\n      // Buildin scale\n      case 'category':\n        return new OrdinalScale({\n          ordinalMeta: model.getCategories(),\n          extent: [Infinity, -Infinity]\n        });\n\n      case 'time':\n        return new TimeScale({\n          locale: model.ecModel.getLocaleModel(),\n          useUTC: model.ecModel.get('useUTC')\n        });\n\n      default:\n        // default to be value\n        return new IntervalScale();\n    }\n  }\n}\n\nfunction getViewRect(model, api) {\n  return layout.getLayoutRect(model.getBoxLayoutParams(), {\n    width: api.getWidth(),\n    height: api.getHeight()\n  }, model.get('padding'));\n}\n\nfunction makeControlIcon(timelineModel, objPath, rect, opts) {\n  var style = opts.style;\n  var icon = graphic.createIcon(timelineModel.get(['controlStyle', objPath]), opts || {}, new BoundingRect(rect[0], rect[1], rect[2], rect[3])); // TODO createIcon won't use style in opt.\n\n  if (style) {\n    icon.setStyle(style);\n  }\n\n  return icon;\n}\n/**\n * Create symbol or update symbol\n * opt: basic position and event handlers\n */\n\n\nfunction giveSymbol(hostModel, itemStyleModel, group, opt, symbol, callback) {\n  var color = itemStyleModel.get('color');\n\n  if (!symbol) {\n    var symbolType = hostModel.get('symbol');\n    symbol = createSymbol(symbolType, -1, -1, 2, 2, color);\n    symbol.setStyle('strokeNoScale', true);\n    group.add(symbol);\n    callback && callback.onCreate(symbol);\n  } else {\n    symbol.setColor(color);\n    group.add(symbol); // Group may be new, also need to add.\n\n    callback && callback.onUpdate(symbol);\n  } // Style\n\n\n  var itemStyle = itemStyleModel.getItemStyle(['color']);\n  symbol.setStyle(itemStyle); // Transform and events.\n\n  opt = merge({\n    rectHover: true,\n    z2: 100\n  }, opt, true);\n  var symbolSize = normalizeSymbolSize(hostModel.get('symbolSize'));\n  opt.scaleX = symbolSize[0] / 2;\n  opt.scaleY = symbolSize[1] / 2;\n  var symbolOffset = normalizeSymbolOffset(hostModel.get('symbolOffset'), symbolSize);\n\n  if (symbolOffset) {\n    opt.x = (opt.x || 0) + symbolOffset[0];\n    opt.y = (opt.y || 0) + symbolOffset[1];\n  }\n\n  var symbolRotate = hostModel.get('symbolRotate');\n  opt.rotation = (symbolRotate || 0) * Math.PI / 180 || 0;\n  symbol.attr(opt); // FIXME\n  // (1) When symbol.style.strokeNoScale is true and updateTransform is not performed,\n  // getBoundingRect will return wrong result.\n  // (This is supposed to be resolved in zrender, but it is a little difficult to\n  // leverage performance and auto updateTransform)\n  // (2) All of ancesters of symbol do not scale, so we can just updateTransform symbol.\n\n  symbol.updateTransform();\n  return symbol;\n}\n\nfunction pointerMoveTo(pointer, progressLine, dataIndex, axis, timelineModel, noAnimation) {\n  if (pointer.dragging) {\n    return;\n  }\n\n  var pointerModel = timelineModel.getModel('checkpointStyle');\n  var toCoord = axis.dataToCoord(timelineModel.getData().get('value', dataIndex));\n\n  if (noAnimation || !pointerModel.get('animation', true)) {\n    pointer.attr({\n      x: toCoord,\n      y: 0\n    });\n    progressLine && progressLine.attr({\n      shape: {\n        x2: toCoord\n      }\n    });\n  } else {\n    var animationCfg = {\n      duration: pointerModel.get('animationDuration', true),\n      easing: pointerModel.get('animationEasing', true)\n    };\n    pointer.stopAnimation(null, true);\n    pointer.animateTo({\n      x: toCoord,\n      y: 0\n    }, animationCfg);\n    progressLine && progressLine.animateTo({\n      shape: {\n        x2: toCoord\n      }\n    }, animationCfg);\n  }\n}\n\nexport default SliderTimelineView;"],"mappings":"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"},"metadata":{},"sourceType":"module"}