{"ast":null,"code":"/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nimport { __extends } from \"tslib\";\n/*\n* A third-party license is embeded for some of the code in this file:\n* The \"scaleLevels\" was originally copied from \"d3.js\" with some\n* modifications made for this project.\n* (See more details in the comment on the definition of \"scaleLevels\" below.)\n* The use of the source code of this file is also subject to the terms\n* and consitions of the license of \"d3.js\" (BSD-3Clause, see\n* </licenses/LICENSE-d3>).\n*/\n// [About UTC and local time zone]:\n// In most cases, `number.parseDate` will treat input data string as local time\n// (except time zone is specified in time string). And `format.formateTime` returns\n// local time by default. option.useUTC is false by default. This design have\n// concidered these common case:\n// (1) Time that is persistent in server is in UTC, but it is needed to be diplayed\n// in local time by default.\n// (2) By default, the input data string (e.g., '2011-01-02') should be displayed\n// as its original time, without any time difference.\n\nimport * as numberUtil from '../util/number.js';\nimport { ONE_SECOND, ONE_MINUTE, ONE_HOUR, ONE_DAY, ONE_YEAR, format, leveledFormat, getUnitValue, timeUnits, fullLeveledFormatter, getPrimaryTimeUnit, isPrimaryTimeUnit, getDefaultFormatPrecisionOfInterval, fullYearGetterName, monthSetterName, fullYearSetterName, dateSetterName, hoursGetterName, hoursSetterName, minutesSetterName, secondsSetterName, millisecondsSetterName, monthGetterName, dateGetterName, minutesGetterName, secondsGetterName, millisecondsGetterName } from '../util/time.js';\nimport * as scaleHelper from './helper.js';\nimport IntervalScale from './Interval.js';\nimport Scale from './Scale.js';\nimport { warn } from '../util/log.js';\nimport { filter, isNumber, map } from 'zrender/lib/core/util.js'; // FIXME 公用？\n\nvar bisect = function (a, x, lo, hi) {\n  while (lo < hi) {\n    var mid = lo + hi >>> 1;\n\n    if (a[mid][1] < x) {\n      lo = mid + 1;\n    } else {\n      hi = mid;\n    }\n  }\n\n  return lo;\n};\n\nvar TimeScale =\n/** @class */\nfunction (_super) {\n  __extends(TimeScale, _super);\n\n  function TimeScale(settings) {\n    var _this = _super.call(this, settings) || this;\n\n    _this.type = 'time';\n    return _this;\n  }\n  /**\n   * Get label is mainly for other components like dataZoom, tooltip.\n   */\n\n\n  TimeScale.prototype.getLabel = function (tick) {\n    var useUTC = this.getSetting('useUTC');\n    return format(tick.value, fullLeveledFormatter[getDefaultFormatPrecisionOfInterval(getPrimaryTimeUnit(this._minLevelUnit))] || fullLeveledFormatter.second, useUTC, this.getSetting('locale'));\n  };\n\n  TimeScale.prototype.getFormattedLabel = function (tick, idx, labelFormatter) {\n    var isUTC = this.getSetting('useUTC');\n    var lang = this.getSetting('locale');\n    return leveledFormat(tick, idx, labelFormatter, lang, isUTC);\n  };\n  /**\n   * @override\n   */\n\n\n  TimeScale.prototype.getTicks = function () {\n    var interval = this._interval;\n    var extent = this._extent;\n    var ticks = []; // If interval is 0, return [];\n\n    if (!interval) {\n      return ticks;\n    }\n\n    ticks.push({\n      value: extent[0],\n      level: 0\n    });\n    var useUTC = this.getSetting('useUTC');\n    var innerTicks = getIntervalTicks(this._minLevelUnit, this._approxInterval, useUTC, extent);\n    ticks = ticks.concat(innerTicks);\n    ticks.push({\n      value: extent[1],\n      level: 0\n    });\n    return ticks;\n  };\n\n  TimeScale.prototype.calcNiceExtent = function (opt) {\n    var extent = this._extent; // If extent start and end are same, expand them\n\n    if (extent[0] === extent[1]) {\n      // Expand extent\n      extent[0] -= ONE_DAY;\n      extent[1] += ONE_DAY;\n    } // If there are no data and extent are [Infinity, -Infinity]\n\n\n    if (extent[1] === -Infinity && extent[0] === Infinity) {\n      var d = new Date();\n      extent[1] = +new Date(d.getFullYear(), d.getMonth(), d.getDate());\n      extent[0] = extent[1] - ONE_DAY;\n    }\n\n    this.calcNiceTicks(opt.splitNumber, opt.minInterval, opt.maxInterval);\n  };\n\n  TimeScale.prototype.calcNiceTicks = function (approxTickNum, minInterval, maxInterval) {\n    approxTickNum = approxTickNum || 10;\n    var extent = this._extent;\n    var span = extent[1] - extent[0];\n    this._approxInterval = span / approxTickNum;\n\n    if (minInterval != null && this._approxInterval < minInterval) {\n      this._approxInterval = minInterval;\n    }\n\n    if (maxInterval != null && this._approxInterval > maxInterval) {\n      this._approxInterval = maxInterval;\n    }\n\n    var scaleIntervalsLen = scaleIntervals.length;\n    var idx = Math.min(bisect(scaleIntervals, this._approxInterval, 0, scaleIntervalsLen), scaleIntervalsLen - 1); // Interval that can be used to calculate ticks\n\n    this._interval = scaleIntervals[idx][1]; // Min level used when picking ticks from top down.\n    // We check one more level to avoid the ticks are to sparse in some case.\n\n    this._minLevelUnit = scaleIntervals[Math.max(idx - 1, 0)][0];\n  };\n\n  TimeScale.prototype.parse = function (val) {\n    // val might be float.\n    return isNumber(val) ? val : +numberUtil.parseDate(val);\n  };\n\n  TimeScale.prototype.contain = function (val) {\n    return scaleHelper.contain(this.parse(val), this._extent);\n  };\n\n  TimeScale.prototype.normalize = function (val) {\n    return scaleHelper.normalize(this.parse(val), this._extent);\n  };\n\n  TimeScale.prototype.scale = function (val) {\n    return scaleHelper.scale(val, this._extent);\n  };\n\n  TimeScale.type = 'time';\n  return TimeScale;\n}(IntervalScale);\n/**\n * This implementation was originally copied from \"d3.js\"\n * <https://github.com/d3/d3/blob/b516d77fb8566b576088e73410437494717ada26/src/time/scale.js>\n * with some modifications made for this program.\n * See the license statement at the head of this file.\n */\n\n\nvar scaleIntervals = [// Format                           interval\n['second', ONE_SECOND], ['minute', ONE_MINUTE], ['hour', ONE_HOUR], ['quarter-day', ONE_HOUR * 6], ['half-day', ONE_HOUR * 12], ['day', ONE_DAY * 1.2], ['half-week', ONE_DAY * 3.5], ['week', ONE_DAY * 7], ['month', ONE_DAY * 31], ['quarter', ONE_DAY * 95], ['half-year', ONE_YEAR / 2], ['year', ONE_YEAR] // 1Y\n];\n\nfunction isUnitValueSame(unit, valueA, valueB, isUTC) {\n  var dateA = numberUtil.parseDate(valueA);\n  var dateB = numberUtil.parseDate(valueB);\n\n  var isSame = function (unit) {\n    return getUnitValue(dateA, unit, isUTC) === getUnitValue(dateB, unit, isUTC);\n  };\n\n  var isSameYear = function () {\n    return isSame('year');\n  }; // const isSameHalfYear = () => isSameYear() && isSame('half-year');\n  // const isSameQuater = () => isSameYear() && isSame('quarter');\n\n\n  var isSameMonth = function () {\n    return isSameYear() && isSame('month');\n  };\n\n  var isSameDay = function () {\n    return isSameMonth() && isSame('day');\n  }; // const isSameHalfDay = () => isSameDay() && isSame('half-day');\n\n\n  var isSameHour = function () {\n    return isSameDay() && isSame('hour');\n  };\n\n  var isSameMinute = function () {\n    return isSameHour() && isSame('minute');\n  };\n\n  var isSameSecond = function () {\n    return isSameMinute() && isSame('second');\n  };\n\n  var isSameMilliSecond = function () {\n    return isSameSecond() && isSame('millisecond');\n  };\n\n  switch (unit) {\n    case 'year':\n      return isSameYear();\n\n    case 'month':\n      return isSameMonth();\n\n    case 'day':\n      return isSameDay();\n\n    case 'hour':\n      return isSameHour();\n\n    case 'minute':\n      return isSameMinute();\n\n    case 'second':\n      return isSameSecond();\n\n    case 'millisecond':\n      return isSameMilliSecond();\n  }\n} // const primaryUnitGetters = {\n//     year: fullYearGetterName(),\n//     month: monthGetterName(),\n//     day: dateGetterName(),\n//     hour: hoursGetterName(),\n//     minute: minutesGetterName(),\n//     second: secondsGetterName(),\n//     millisecond: millisecondsGetterName()\n// };\n// const primaryUnitUTCGetters = {\n//     year: fullYearGetterName(true),\n//     month: monthGetterName(true),\n//     day: dateGetterName(true),\n//     hour: hoursGetterName(true),\n//     minute: minutesGetterName(true),\n//     second: secondsGetterName(true),\n//     millisecond: millisecondsGetterName(true)\n// };\n// function moveTick(date: Date, unitName: TimeUnit, step: number, isUTC: boolean) {\n//     step = step || 1;\n//     switch (getPrimaryTimeUnit(unitName)) {\n//         case 'year':\n//             date[fullYearSetterName(isUTC)](date[fullYearGetterName(isUTC)]() + step);\n//             break;\n//         case 'month':\n//             date[monthSetterName(isUTC)](date[monthGetterName(isUTC)]() + step);\n//             break;\n//         case 'day':\n//             date[dateSetterName(isUTC)](date[dateGetterName(isUTC)]() + step);\n//             break;\n//         case 'hour':\n//             date[hoursSetterName(isUTC)](date[hoursGetterName(isUTC)]() + step);\n//             break;\n//         case 'minute':\n//             date[minutesSetterName(isUTC)](date[minutesGetterName(isUTC)]() + step);\n//             break;\n//         case 'second':\n//             date[secondsSetterName(isUTC)](date[secondsGetterName(isUTC)]() + step);\n//             break;\n//         case 'millisecond':\n//             date[millisecondsSetterName(isUTC)](date[millisecondsGetterName(isUTC)]() + step);\n//             break;\n//     }\n//     return date.getTime();\n// }\n// const DATE_INTERVALS = [[8, 7.5], [4, 3.5], [2, 1.5]];\n// const MONTH_INTERVALS = [[6, 5.5], [3, 2.5], [2, 1.5]];\n// const MINUTES_SECONDS_INTERVALS = [[30, 30], [20, 20], [15, 15], [10, 10], [5, 5], [2, 2]];\n\n\nfunction getDateInterval(approxInterval, daysInMonth) {\n  approxInterval /= ONE_DAY;\n  return approxInterval > 16 ? 16 // Math.floor(daysInMonth / 2) + 1  // In this case we only want one tick betwen two month.\n  : approxInterval > 7.5 ? 7 // TODO week 7 or day 8?\n  : approxInterval > 3.5 ? 4 : approxInterval > 1.5 ? 2 : 1;\n}\n\nfunction getMonthInterval(approxInterval) {\n  var APPROX_ONE_MONTH = 30 * ONE_DAY;\n  approxInterval /= APPROX_ONE_MONTH;\n  return approxInterval > 6 ? 6 : approxInterval > 3 ? 3 : approxInterval > 2 ? 2 : 1;\n}\n\nfunction getHourInterval(approxInterval) {\n  approxInterval /= ONE_HOUR;\n  return approxInterval > 12 ? 12 : approxInterval > 6 ? 6 : approxInterval > 3.5 ? 4 : approxInterval > 2 ? 2 : 1;\n}\n\nfunction getMinutesAndSecondsInterval(approxInterval, isMinutes) {\n  approxInterval /= isMinutes ? ONE_MINUTE : ONE_SECOND;\n  return approxInterval > 30 ? 30 : approxInterval > 20 ? 20 : approxInterval > 15 ? 15 : approxInterval > 10 ? 10 : approxInterval > 5 ? 5 : approxInterval > 2 ? 2 : 1;\n}\n\nfunction getMillisecondsInterval(approxInterval) {\n  return numberUtil.nice(approxInterval, true);\n}\n\nfunction getFirstTimestampOfUnit(date, unitName, isUTC) {\n  var outDate = new Date(date);\n\n  switch (getPrimaryTimeUnit(unitName)) {\n    case 'year':\n    case 'month':\n      outDate[monthSetterName(isUTC)](0);\n\n    case 'day':\n      outDate[dateSetterName(isUTC)](1);\n\n    case 'hour':\n      outDate[hoursSetterName(isUTC)](0);\n\n    case 'minute':\n      outDate[minutesSetterName(isUTC)](0);\n\n    case 'second':\n      outDate[secondsSetterName(isUTC)](0);\n      outDate[millisecondsSetterName(isUTC)](0);\n  }\n\n  return outDate.getTime();\n}\n\nfunction getIntervalTicks(bottomUnitName, approxInterval, isUTC, extent) {\n  var safeLimit = 10000;\n  var unitNames = timeUnits;\n  var iter = 0;\n\n  function addTicksInSpan(interval, minTimestamp, maxTimestamp, getMethodName, setMethodName, isDate, out) {\n    var date = new Date(minTimestamp);\n    var dateTime = minTimestamp;\n    var d = date[getMethodName](); // if (isDate) {\n    //     d -= 1; // Starts with 0;   PENDING\n    // }\n\n    while (dateTime < maxTimestamp && dateTime <= extent[1]) {\n      out.push({\n        value: dateTime\n      });\n      d += interval;\n      date[setMethodName](d);\n      dateTime = date.getTime();\n    } // This extra tick is for calcuating ticks of next level. Will not been added to the final result\n\n\n    out.push({\n      value: dateTime,\n      notAdd: true\n    });\n  }\n\n  function addLevelTicks(unitName, lastLevelTicks, levelTicks) {\n    var newAddedTicks = [];\n    var isFirstLevel = !lastLevelTicks.length;\n\n    if (isUnitValueSame(getPrimaryTimeUnit(unitName), extent[0], extent[1], isUTC)) {\n      return;\n    }\n\n    if (isFirstLevel) {\n      lastLevelTicks = [{\n        // TODO Optimize. Not include so may ticks.\n        value: getFirstTimestampOfUnit(new Date(extent[0]), unitName, isUTC)\n      }, {\n        value: extent[1]\n      }];\n    }\n\n    for (var i = 0; i < lastLevelTicks.length - 1; i++) {\n      var startTick = lastLevelTicks[i].value;\n      var endTick = lastLevelTicks[i + 1].value;\n\n      if (startTick === endTick) {\n        continue;\n      }\n\n      var interval = void 0;\n      var getterName = void 0;\n      var setterName = void 0;\n      var isDate = false;\n\n      switch (unitName) {\n        case 'year':\n          interval = Math.max(1, Math.round(approxInterval / ONE_DAY / 365));\n          getterName = fullYearGetterName(isUTC);\n          setterName = fullYearSetterName(isUTC);\n          break;\n\n        case 'half-year':\n        case 'quarter':\n        case 'month':\n          interval = getMonthInterval(approxInterval);\n          getterName = monthGetterName(isUTC);\n          setterName = monthSetterName(isUTC);\n          break;\n\n        case 'week': // PENDING If week is added. Ignore day.\n\n        case 'half-week':\n        case 'day':\n          interval = getDateInterval(approxInterval, 31); // Use 32 days and let interval been 16\n\n          getterName = dateGetterName(isUTC);\n          setterName = dateSetterName(isUTC);\n          isDate = true;\n          break;\n\n        case 'half-day':\n        case 'quarter-day':\n        case 'hour':\n          interval = getHourInterval(approxInterval);\n          getterName = hoursGetterName(isUTC);\n          setterName = hoursSetterName(isUTC);\n          break;\n\n        case 'minute':\n          interval = getMinutesAndSecondsInterval(approxInterval, true);\n          getterName = minutesGetterName(isUTC);\n          setterName = minutesSetterName(isUTC);\n          break;\n\n        case 'second':\n          interval = getMinutesAndSecondsInterval(approxInterval, false);\n          getterName = secondsGetterName(isUTC);\n          setterName = secondsSetterName(isUTC);\n          break;\n\n        case 'millisecond':\n          interval = getMillisecondsInterval(approxInterval);\n          getterName = millisecondsGetterName(isUTC);\n          setterName = millisecondsSetterName(isUTC);\n          break;\n      }\n\n      addTicksInSpan(interval, startTick, endTick, getterName, setterName, isDate, newAddedTicks);\n\n      if (unitName === 'year' && levelTicks.length > 1 && i === 0) {\n        // Add nearest years to the left extent.\n        levelTicks.unshift({\n          value: levelTicks[0].value - interval\n        });\n      }\n    }\n\n    for (var i = 0; i < newAddedTicks.length; i++) {\n      levelTicks.push(newAddedTicks[i]);\n    } // newAddedTicks.length && console.log(unitName, newAddedTicks);\n\n\n    return newAddedTicks;\n  }\n\n  var levelsTicks = [];\n  var currentLevelTicks = [];\n  var tickCount = 0;\n  var lastLevelTickCount = 0;\n\n  for (var i = 0; i < unitNames.length && iter++ < safeLimit; ++i) {\n    var primaryTimeUnit = getPrimaryTimeUnit(unitNames[i]);\n\n    if (!isPrimaryTimeUnit(unitNames[i])) {\n      // TODO\n      continue;\n    }\n\n    addLevelTicks(unitNames[i], levelsTicks[levelsTicks.length - 1] || [], currentLevelTicks);\n    var nextPrimaryTimeUnit = unitNames[i + 1] ? getPrimaryTimeUnit(unitNames[i + 1]) : null;\n\n    if (primaryTimeUnit !== nextPrimaryTimeUnit) {\n      if (currentLevelTicks.length) {\n        lastLevelTickCount = tickCount; // Remove the duplicate so the tick count can be precisely.\n\n        currentLevelTicks.sort(function (a, b) {\n          return a.value - b.value;\n        });\n        var levelTicksRemoveDuplicated = [];\n\n        for (var i_1 = 0; i_1 < currentLevelTicks.length; ++i_1) {\n          var tickValue = currentLevelTicks[i_1].value;\n\n          if (i_1 === 0 || currentLevelTicks[i_1 - 1].value !== tickValue) {\n            levelTicksRemoveDuplicated.push(currentLevelTicks[i_1]);\n\n            if (tickValue >= extent[0] && tickValue <= extent[1]) {\n              tickCount++;\n            }\n          }\n        }\n\n        var targetTickNum = (extent[1] - extent[0]) / approxInterval; // Added too much in this level and not too less in last level\n\n        if (tickCount > targetTickNum * 1.5 && lastLevelTickCount > targetTickNum / 1.5) {\n          break;\n        } // Only treat primary time unit as one level.\n\n\n        levelsTicks.push(levelTicksRemoveDuplicated);\n\n        if (tickCount > targetTickNum || bottomUnitName === unitNames[i]) {\n          break;\n        }\n      } // Reset if next unitName is primary\n\n\n      currentLevelTicks = [];\n    }\n  }\n\n  if (process.env.NODE_ENV !== 'production') {\n    if (iter >= safeLimit) {\n      warn('Exceed safe limit.');\n    }\n  }\n\n  var levelsTicksInExtent = filter(map(levelsTicks, function (levelTicks) {\n    return filter(levelTicks, function (tick) {\n      return tick.value >= extent[0] && tick.value <= extent[1] && !tick.notAdd;\n    });\n  }), function (levelTicks) {\n    return levelTicks.length > 0;\n  });\n  var ticks = [];\n  var maxLevel = levelsTicksInExtent.length - 1;\n\n  for (var i = 0; i < levelsTicksInExtent.length; ++i) {\n    var levelTicks = levelsTicksInExtent[i];\n\n    for (var k = 0; k < levelTicks.length; ++k) {\n      ticks.push({\n        value: levelTicks[k].value,\n        level: maxLevel - i\n      });\n    }\n  }\n\n  ticks.sort(function (a, b) {\n    return a.value - b.value;\n  }); // Remove duplicates\n\n  var result = [];\n\n  for (var i = 0; i < ticks.length; ++i) {\n    if (i === 0 || ticks[i].value !== ticks[i - 1].value) {\n      result.push(ticks[i]);\n    }\n  }\n\n  return result;\n}\n\nScale.registerClass(TimeScale);\nexport default TimeScale;","map":{"version":3,"names":["__extends","numberUtil","ONE_SECOND","ONE_MINUTE","ONE_HOUR","ONE_DAY","ONE_YEAR","format","leveledFormat","getUnitValue","timeUnits","fullLeveledFormatter","getPrimaryTimeUnit","isPrimaryTimeUnit","getDefaultFormatPrecisionOfInterval","fullYearGetterName","monthSetterName","fullYearSetterName","dateSetterName","hoursGetterName","hoursSetterName","minutesSetterName","secondsSetterName","millisecondsSetterName","monthGetterName","dateGetterName","minutesGetterName","secondsGetterName","millisecondsGetterName","scaleHelper","IntervalScale","Scale","warn","filter","isNumber","map","bisect","a","x","lo","hi","mid","TimeScale","_super","settings","_this","call","type","prototype","getLabel","tick","useUTC","getSetting","value","_minLevelUnit","second","getFormattedLabel","idx","labelFormatter","isUTC","lang","getTicks","interval","_interval","extent","_extent","ticks","push","level","innerTicks","getIntervalTicks","_approxInterval","concat","calcNiceExtent","opt","Infinity","d","Date","getFullYear","getMonth","getDate","calcNiceTicks","splitNumber","minInterval","maxInterval","approxTickNum","span","scaleIntervalsLen","scaleIntervals","length","Math","min","max","parse","val","parseDate","contain","normalize","scale","isUnitValueSame","unit","valueA","valueB","dateA","dateB","isSame","isSameYear","isSameMonth","isSameDay","isSameHour","isSameMinute","isSameSecond","isSameMilliSecond","getDateInterval","approxInterval","daysInMonth","getMonthInterval","APPROX_ONE_MONTH","getHourInterval","getMinutesAndSecondsInterval","isMinutes","getMillisecondsInterval","nice","getFirstTimestampOfUnit","date","unitName","outDate","getTime","bottomUnitName","safeLimit","unitNames","iter","addTicksInSpan","minTimestamp","maxTimestamp","getMethodName","setMethodName","isDate","out","dateTime","notAdd","addLevelTicks","lastLevelTicks","levelTicks","newAddedTicks","isFirstLevel","i","startTick","endTick","getterName","setterName","round","unshift","levelsTicks","currentLevelTicks","tickCount","lastLevelTickCount","primaryTimeUnit","nextPrimaryTimeUnit","sort","b","levelTicksRemoveDuplicated","i_1","tickValue","targetTickNum","process","env","NODE_ENV","levelsTicksInExtent","maxLevel","k","result","registerClass"],"sources":["/home/siyi/Projects/radi-demo/radi-showing/node_modules/echarts/lib/scale/Time.js"],"sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nimport { __extends } from \"tslib\";\n/*\n* A third-party license is embeded for some of the code in this file:\n* The \"scaleLevels\" was originally copied from \"d3.js\" with some\n* modifications made for this project.\n* (See more details in the comment on the definition of \"scaleLevels\" below.)\n* The use of the source code of this file is also subject to the terms\n* and consitions of the license of \"d3.js\" (BSD-3Clause, see\n* </licenses/LICENSE-d3>).\n*/\n// [About UTC and local time zone]:\n// In most cases, `number.parseDate` will treat input data string as local time\n// (except time zone is specified in time string). And `format.formateTime` returns\n// local time by default. option.useUTC is false by default. This design have\n// concidered these common case:\n// (1) Time that is persistent in server is in UTC, but it is needed to be diplayed\n// in local time by default.\n// (2) By default, the input data string (e.g., '2011-01-02') should be displayed\n// as its original time, without any time difference.\n\nimport * as numberUtil from '../util/number.js';\nimport { ONE_SECOND, ONE_MINUTE, ONE_HOUR, ONE_DAY, ONE_YEAR, format, leveledFormat, getUnitValue, timeUnits, fullLeveledFormatter, getPrimaryTimeUnit, isPrimaryTimeUnit, getDefaultFormatPrecisionOfInterval, fullYearGetterName, monthSetterName, fullYearSetterName, dateSetterName, hoursGetterName, hoursSetterName, minutesSetterName, secondsSetterName, millisecondsSetterName, monthGetterName, dateGetterName, minutesGetterName, secondsGetterName, millisecondsGetterName } from '../util/time.js';\nimport * as scaleHelper from './helper.js';\nimport IntervalScale from './Interval.js';\nimport Scale from './Scale.js';\nimport { warn } from '../util/log.js';\nimport { filter, isNumber, map } from 'zrender/lib/core/util.js'; // FIXME 公用？\n\nvar bisect = function (a, x, lo, hi) {\n  while (lo < hi) {\n    var mid = lo + hi >>> 1;\n\n    if (a[mid][1] < x) {\n      lo = mid + 1;\n    } else {\n      hi = mid;\n    }\n  }\n\n  return lo;\n};\n\nvar TimeScale =\n/** @class */\nfunction (_super) {\n  __extends(TimeScale, _super);\n\n  function TimeScale(settings) {\n    var _this = _super.call(this, settings) || this;\n\n    _this.type = 'time';\n    return _this;\n  }\n  /**\n   * Get label is mainly for other components like dataZoom, tooltip.\n   */\n\n\n  TimeScale.prototype.getLabel = function (tick) {\n    var useUTC = this.getSetting('useUTC');\n    return format(tick.value, fullLeveledFormatter[getDefaultFormatPrecisionOfInterval(getPrimaryTimeUnit(this._minLevelUnit))] || fullLeveledFormatter.second, useUTC, this.getSetting('locale'));\n  };\n\n  TimeScale.prototype.getFormattedLabel = function (tick, idx, labelFormatter) {\n    var isUTC = this.getSetting('useUTC');\n    var lang = this.getSetting('locale');\n    return leveledFormat(tick, idx, labelFormatter, lang, isUTC);\n  };\n  /**\n   * @override\n   */\n\n\n  TimeScale.prototype.getTicks = function () {\n    var interval = this._interval;\n    var extent = this._extent;\n    var ticks = []; // If interval is 0, return [];\n\n    if (!interval) {\n      return ticks;\n    }\n\n    ticks.push({\n      value: extent[0],\n      level: 0\n    });\n    var useUTC = this.getSetting('useUTC');\n    var innerTicks = getIntervalTicks(this._minLevelUnit, this._approxInterval, useUTC, extent);\n    ticks = ticks.concat(innerTicks);\n    ticks.push({\n      value: extent[1],\n      level: 0\n    });\n    return ticks;\n  };\n\n  TimeScale.prototype.calcNiceExtent = function (opt) {\n    var extent = this._extent; // If extent start and end are same, expand them\n\n    if (extent[0] === extent[1]) {\n      // Expand extent\n      extent[0] -= ONE_DAY;\n      extent[1] += ONE_DAY;\n    } // If there are no data and extent are [Infinity, -Infinity]\n\n\n    if (extent[1] === -Infinity && extent[0] === Infinity) {\n      var d = new Date();\n      extent[1] = +new Date(d.getFullYear(), d.getMonth(), d.getDate());\n      extent[0] = extent[1] - ONE_DAY;\n    }\n\n    this.calcNiceTicks(opt.splitNumber, opt.minInterval, opt.maxInterval);\n  };\n\n  TimeScale.prototype.calcNiceTicks = function (approxTickNum, minInterval, maxInterval) {\n    approxTickNum = approxTickNum || 10;\n    var extent = this._extent;\n    var span = extent[1] - extent[0];\n    this._approxInterval = span / approxTickNum;\n\n    if (minInterval != null && this._approxInterval < minInterval) {\n      this._approxInterval = minInterval;\n    }\n\n    if (maxInterval != null && this._approxInterval > maxInterval) {\n      this._approxInterval = maxInterval;\n    }\n\n    var scaleIntervalsLen = scaleIntervals.length;\n    var idx = Math.min(bisect(scaleIntervals, this._approxInterval, 0, scaleIntervalsLen), scaleIntervalsLen - 1); // Interval that can be used to calculate ticks\n\n    this._interval = scaleIntervals[idx][1]; // Min level used when picking ticks from top down.\n    // We check one more level to avoid the ticks are to sparse in some case.\n\n    this._minLevelUnit = scaleIntervals[Math.max(idx - 1, 0)][0];\n  };\n\n  TimeScale.prototype.parse = function (val) {\n    // val might be float.\n    return isNumber(val) ? val : +numberUtil.parseDate(val);\n  };\n\n  TimeScale.prototype.contain = function (val) {\n    return scaleHelper.contain(this.parse(val), this._extent);\n  };\n\n  TimeScale.prototype.normalize = function (val) {\n    return scaleHelper.normalize(this.parse(val), this._extent);\n  };\n\n  TimeScale.prototype.scale = function (val) {\n    return scaleHelper.scale(val, this._extent);\n  };\n\n  TimeScale.type = 'time';\n  return TimeScale;\n}(IntervalScale);\n/**\n * This implementation was originally copied from \"d3.js\"\n * <https://github.com/d3/d3/blob/b516d77fb8566b576088e73410437494717ada26/src/time/scale.js>\n * with some modifications made for this program.\n * See the license statement at the head of this file.\n */\n\n\nvar scaleIntervals = [// Format                           interval\n['second', ONE_SECOND], ['minute', ONE_MINUTE], ['hour', ONE_HOUR], ['quarter-day', ONE_HOUR * 6], ['half-day', ONE_HOUR * 12], ['day', ONE_DAY * 1.2], ['half-week', ONE_DAY * 3.5], ['week', ONE_DAY * 7], ['month', ONE_DAY * 31], ['quarter', ONE_DAY * 95], ['half-year', ONE_YEAR / 2], ['year', ONE_YEAR] // 1Y\n];\n\nfunction isUnitValueSame(unit, valueA, valueB, isUTC) {\n  var dateA = numberUtil.parseDate(valueA);\n  var dateB = numberUtil.parseDate(valueB);\n\n  var isSame = function (unit) {\n    return getUnitValue(dateA, unit, isUTC) === getUnitValue(dateB, unit, isUTC);\n  };\n\n  var isSameYear = function () {\n    return isSame('year');\n  }; // const isSameHalfYear = () => isSameYear() && isSame('half-year');\n  // const isSameQuater = () => isSameYear() && isSame('quarter');\n\n\n  var isSameMonth = function () {\n    return isSameYear() && isSame('month');\n  };\n\n  var isSameDay = function () {\n    return isSameMonth() && isSame('day');\n  }; // const isSameHalfDay = () => isSameDay() && isSame('half-day');\n\n\n  var isSameHour = function () {\n    return isSameDay() && isSame('hour');\n  };\n\n  var isSameMinute = function () {\n    return isSameHour() && isSame('minute');\n  };\n\n  var isSameSecond = function () {\n    return isSameMinute() && isSame('second');\n  };\n\n  var isSameMilliSecond = function () {\n    return isSameSecond() && isSame('millisecond');\n  };\n\n  switch (unit) {\n    case 'year':\n      return isSameYear();\n\n    case 'month':\n      return isSameMonth();\n\n    case 'day':\n      return isSameDay();\n\n    case 'hour':\n      return isSameHour();\n\n    case 'minute':\n      return isSameMinute();\n\n    case 'second':\n      return isSameSecond();\n\n    case 'millisecond':\n      return isSameMilliSecond();\n  }\n} // const primaryUnitGetters = {\n//     year: fullYearGetterName(),\n//     month: monthGetterName(),\n//     day: dateGetterName(),\n//     hour: hoursGetterName(),\n//     minute: minutesGetterName(),\n//     second: secondsGetterName(),\n//     millisecond: millisecondsGetterName()\n// };\n// const primaryUnitUTCGetters = {\n//     year: fullYearGetterName(true),\n//     month: monthGetterName(true),\n//     day: dateGetterName(true),\n//     hour: hoursGetterName(true),\n//     minute: minutesGetterName(true),\n//     second: secondsGetterName(true),\n//     millisecond: millisecondsGetterName(true)\n// };\n// function moveTick(date: Date, unitName: TimeUnit, step: number, isUTC: boolean) {\n//     step = step || 1;\n//     switch (getPrimaryTimeUnit(unitName)) {\n//         case 'year':\n//             date[fullYearSetterName(isUTC)](date[fullYearGetterName(isUTC)]() + step);\n//             break;\n//         case 'month':\n//             date[monthSetterName(isUTC)](date[monthGetterName(isUTC)]() + step);\n//             break;\n//         case 'day':\n//             date[dateSetterName(isUTC)](date[dateGetterName(isUTC)]() + step);\n//             break;\n//         case 'hour':\n//             date[hoursSetterName(isUTC)](date[hoursGetterName(isUTC)]() + step);\n//             break;\n//         case 'minute':\n//             date[minutesSetterName(isUTC)](date[minutesGetterName(isUTC)]() + step);\n//             break;\n//         case 'second':\n//             date[secondsSetterName(isUTC)](date[secondsGetterName(isUTC)]() + step);\n//             break;\n//         case 'millisecond':\n//             date[millisecondsSetterName(isUTC)](date[millisecondsGetterName(isUTC)]() + step);\n//             break;\n//     }\n//     return date.getTime();\n// }\n// const DATE_INTERVALS = [[8, 7.5], [4, 3.5], [2, 1.5]];\n// const MONTH_INTERVALS = [[6, 5.5], [3, 2.5], [2, 1.5]];\n// const MINUTES_SECONDS_INTERVALS = [[30, 30], [20, 20], [15, 15], [10, 10], [5, 5], [2, 2]];\n\n\nfunction getDateInterval(approxInterval, daysInMonth) {\n  approxInterval /= ONE_DAY;\n  return approxInterval > 16 ? 16 // Math.floor(daysInMonth / 2) + 1  // In this case we only want one tick betwen two month.\n  : approxInterval > 7.5 ? 7 // TODO week 7 or day 8?\n  : approxInterval > 3.5 ? 4 : approxInterval > 1.5 ? 2 : 1;\n}\n\nfunction getMonthInterval(approxInterval) {\n  var APPROX_ONE_MONTH = 30 * ONE_DAY;\n  approxInterval /= APPROX_ONE_MONTH;\n  return approxInterval > 6 ? 6 : approxInterval > 3 ? 3 : approxInterval > 2 ? 2 : 1;\n}\n\nfunction getHourInterval(approxInterval) {\n  approxInterval /= ONE_HOUR;\n  return approxInterval > 12 ? 12 : approxInterval > 6 ? 6 : approxInterval > 3.5 ? 4 : approxInterval > 2 ? 2 : 1;\n}\n\nfunction getMinutesAndSecondsInterval(approxInterval, isMinutes) {\n  approxInterval /= isMinutes ? ONE_MINUTE : ONE_SECOND;\n  return approxInterval > 30 ? 30 : approxInterval > 20 ? 20 : approxInterval > 15 ? 15 : approxInterval > 10 ? 10 : approxInterval > 5 ? 5 : approxInterval > 2 ? 2 : 1;\n}\n\nfunction getMillisecondsInterval(approxInterval) {\n  return numberUtil.nice(approxInterval, true);\n}\n\nfunction getFirstTimestampOfUnit(date, unitName, isUTC) {\n  var outDate = new Date(date);\n\n  switch (getPrimaryTimeUnit(unitName)) {\n    case 'year':\n    case 'month':\n      outDate[monthSetterName(isUTC)](0);\n\n    case 'day':\n      outDate[dateSetterName(isUTC)](1);\n\n    case 'hour':\n      outDate[hoursSetterName(isUTC)](0);\n\n    case 'minute':\n      outDate[minutesSetterName(isUTC)](0);\n\n    case 'second':\n      outDate[secondsSetterName(isUTC)](0);\n      outDate[millisecondsSetterName(isUTC)](0);\n  }\n\n  return outDate.getTime();\n}\n\nfunction getIntervalTicks(bottomUnitName, approxInterval, isUTC, extent) {\n  var safeLimit = 10000;\n  var unitNames = timeUnits;\n  var iter = 0;\n\n  function addTicksInSpan(interval, minTimestamp, maxTimestamp, getMethodName, setMethodName, isDate, out) {\n    var date = new Date(minTimestamp);\n    var dateTime = minTimestamp;\n    var d = date[getMethodName](); // if (isDate) {\n    //     d -= 1; // Starts with 0;   PENDING\n    // }\n\n    while (dateTime < maxTimestamp && dateTime <= extent[1]) {\n      out.push({\n        value: dateTime\n      });\n      d += interval;\n      date[setMethodName](d);\n      dateTime = date.getTime();\n    } // This extra tick is for calcuating ticks of next level. Will not been added to the final result\n\n\n    out.push({\n      value: dateTime,\n      notAdd: true\n    });\n  }\n\n  function addLevelTicks(unitName, lastLevelTicks, levelTicks) {\n    var newAddedTicks = [];\n    var isFirstLevel = !lastLevelTicks.length;\n\n    if (isUnitValueSame(getPrimaryTimeUnit(unitName), extent[0], extent[1], isUTC)) {\n      return;\n    }\n\n    if (isFirstLevel) {\n      lastLevelTicks = [{\n        // TODO Optimize. Not include so may ticks.\n        value: getFirstTimestampOfUnit(new Date(extent[0]), unitName, isUTC)\n      }, {\n        value: extent[1]\n      }];\n    }\n\n    for (var i = 0; i < lastLevelTicks.length - 1; i++) {\n      var startTick = lastLevelTicks[i].value;\n      var endTick = lastLevelTicks[i + 1].value;\n\n      if (startTick === endTick) {\n        continue;\n      }\n\n      var interval = void 0;\n      var getterName = void 0;\n      var setterName = void 0;\n      var isDate = false;\n\n      switch (unitName) {\n        case 'year':\n          interval = Math.max(1, Math.round(approxInterval / ONE_DAY / 365));\n          getterName = fullYearGetterName(isUTC);\n          setterName = fullYearSetterName(isUTC);\n          break;\n\n        case 'half-year':\n        case 'quarter':\n        case 'month':\n          interval = getMonthInterval(approxInterval);\n          getterName = monthGetterName(isUTC);\n          setterName = monthSetterName(isUTC);\n          break;\n\n        case 'week': // PENDING If week is added. Ignore day.\n\n        case 'half-week':\n        case 'day':\n          interval = getDateInterval(approxInterval, 31); // Use 32 days and let interval been 16\n\n          getterName = dateGetterName(isUTC);\n          setterName = dateSetterName(isUTC);\n          isDate = true;\n          break;\n\n        case 'half-day':\n        case 'quarter-day':\n        case 'hour':\n          interval = getHourInterval(approxInterval);\n          getterName = hoursGetterName(isUTC);\n          setterName = hoursSetterName(isUTC);\n          break;\n\n        case 'minute':\n          interval = getMinutesAndSecondsInterval(approxInterval, true);\n          getterName = minutesGetterName(isUTC);\n          setterName = minutesSetterName(isUTC);\n          break;\n\n        case 'second':\n          interval = getMinutesAndSecondsInterval(approxInterval, false);\n          getterName = secondsGetterName(isUTC);\n          setterName = secondsSetterName(isUTC);\n          break;\n\n        case 'millisecond':\n          interval = getMillisecondsInterval(approxInterval);\n          getterName = millisecondsGetterName(isUTC);\n          setterName = millisecondsSetterName(isUTC);\n          break;\n      }\n\n      addTicksInSpan(interval, startTick, endTick, getterName, setterName, isDate, newAddedTicks);\n\n      if (unitName === 'year' && levelTicks.length > 1 && i === 0) {\n        // Add nearest years to the left extent.\n        levelTicks.unshift({\n          value: levelTicks[0].value - interval\n        });\n      }\n    }\n\n    for (var i = 0; i < newAddedTicks.length; i++) {\n      levelTicks.push(newAddedTicks[i]);\n    } // newAddedTicks.length && console.log(unitName, newAddedTicks);\n\n\n    return newAddedTicks;\n  }\n\n  var levelsTicks = [];\n  var currentLevelTicks = [];\n  var tickCount = 0;\n  var lastLevelTickCount = 0;\n\n  for (var i = 0; i < unitNames.length && iter++ < safeLimit; ++i) {\n    var primaryTimeUnit = getPrimaryTimeUnit(unitNames[i]);\n\n    if (!isPrimaryTimeUnit(unitNames[i])) {\n      // TODO\n      continue;\n    }\n\n    addLevelTicks(unitNames[i], levelsTicks[levelsTicks.length - 1] || [], currentLevelTicks);\n    var nextPrimaryTimeUnit = unitNames[i + 1] ? getPrimaryTimeUnit(unitNames[i + 1]) : null;\n\n    if (primaryTimeUnit !== nextPrimaryTimeUnit) {\n      if (currentLevelTicks.length) {\n        lastLevelTickCount = tickCount; // Remove the duplicate so the tick count can be precisely.\n\n        currentLevelTicks.sort(function (a, b) {\n          return a.value - b.value;\n        });\n        var levelTicksRemoveDuplicated = [];\n\n        for (var i_1 = 0; i_1 < currentLevelTicks.length; ++i_1) {\n          var tickValue = currentLevelTicks[i_1].value;\n\n          if (i_1 === 0 || currentLevelTicks[i_1 - 1].value !== tickValue) {\n            levelTicksRemoveDuplicated.push(currentLevelTicks[i_1]);\n\n            if (tickValue >= extent[0] && tickValue <= extent[1]) {\n              tickCount++;\n            }\n          }\n        }\n\n        var targetTickNum = (extent[1] - extent[0]) / approxInterval; // Added too much in this level and not too less in last level\n\n        if (tickCount > targetTickNum * 1.5 && lastLevelTickCount > targetTickNum / 1.5) {\n          break;\n        } // Only treat primary time unit as one level.\n\n\n        levelsTicks.push(levelTicksRemoveDuplicated);\n\n        if (tickCount > targetTickNum || bottomUnitName === unitNames[i]) {\n          break;\n        }\n      } // Reset if next unitName is primary\n\n\n      currentLevelTicks = [];\n    }\n  }\n\n  if (process.env.NODE_ENV !== 'production') {\n    if (iter >= safeLimit) {\n      warn('Exceed safe limit.');\n    }\n  }\n\n  var levelsTicksInExtent = filter(map(levelsTicks, function (levelTicks) {\n    return filter(levelTicks, function (tick) {\n      return tick.value >= extent[0] && tick.value <= extent[1] && !tick.notAdd;\n    });\n  }), function (levelTicks) {\n    return levelTicks.length > 0;\n  });\n  var ticks = [];\n  var maxLevel = levelsTicksInExtent.length - 1;\n\n  for (var i = 0; i < levelsTicksInExtent.length; ++i) {\n    var levelTicks = levelsTicksInExtent[i];\n\n    for (var k = 0; k < levelTicks.length; ++k) {\n      ticks.push({\n        value: levelTicks[k].value,\n        level: maxLevel - i\n      });\n    }\n  }\n\n  ticks.sort(function (a, b) {\n    return a.value - b.value;\n  }); // Remove duplicates\n\n  var result = [];\n\n  for (var i = 0; i < ticks.length; ++i) {\n    if (i === 0 || ticks[i].value !== ticks[i - 1].value) {\n      result.push(ticks[i]);\n    }\n  }\n\n  return result;\n}\n\nScale.registerClass(TimeScale);\nexport default TimeScale;"],"mappings":"AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASA,SAAT,QAA0B,OAA1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAO,KAAKC,UAAZ,MAA4B,mBAA5B;AACA,SAASC,UAAT,EAAqBC,UAArB,EAAiCC,QAAjC,EAA2CC,OAA3C,EAAoDC,QAApD,EAA8DC,MAA9D,EAAsEC,aAAtE,EAAqFC,YAArF,EAAmGC,SAAnG,EAA8GC,oBAA9G,EAAoIC,kBAApI,EAAwJC,iBAAxJ,EAA2KC,mCAA3K,EAAgNC,kBAAhN,EAAoOC,eAApO,EAAqPC,kBAArP,EAAyQC,cAAzQ,EAAyRC,eAAzR,EAA0SC,eAA1S,EAA2TC,iBAA3T,EAA8UC,iBAA9U,EAAiWC,sBAAjW,EAAyXC,eAAzX,EAA0YC,cAA1Y,EAA0ZC,iBAA1Z,EAA6aC,iBAA7a,EAAgcC,sBAAhc,QAA8d,iBAA9d;AACA,OAAO,KAAKC,WAAZ,MAA6B,aAA7B;AACA,OAAOC,aAAP,MAA0B,eAA1B;AACA,OAAOC,KAAP,MAAkB,YAAlB;AACA,SAASC,IAAT,QAAqB,gBAArB;AACA,SAASC,MAAT,EAAiBC,QAAjB,EAA2BC,GAA3B,QAAsC,0BAAtC,C,CAAkE;;AAElE,IAAIC,MAAM,GAAG,UAAUC,CAAV,EAAaC,CAAb,EAAgBC,EAAhB,EAAoBC,EAApB,EAAwB;EACnC,OAAOD,EAAE,GAAGC,EAAZ,EAAgB;IACd,IAAIC,GAAG,GAAGF,EAAE,GAAGC,EAAL,KAAY,CAAtB;;IAEA,IAAIH,CAAC,CAACI,GAAD,CAAD,CAAO,CAAP,IAAYH,CAAhB,EAAmB;MACjBC,EAAE,GAAGE,GAAG,GAAG,CAAX;IACD,CAFD,MAEO;MACLD,EAAE,GAAGC,GAAL;IACD;EACF;;EAED,OAAOF,EAAP;AACD,CAZD;;AAcA,IAAIG,SAAS;AACb;AACA,UAAUC,MAAV,EAAkB;EAChB3C,SAAS,CAAC0C,SAAD,EAAYC,MAAZ,CAAT;;EAEA,SAASD,SAAT,CAAmBE,QAAnB,EAA6B;IAC3B,IAAIC,KAAK,GAAGF,MAAM,CAACG,IAAP,CAAY,IAAZ,EAAkBF,QAAlB,KAA+B,IAA3C;;IAEAC,KAAK,CAACE,IAAN,GAAa,MAAb;IACA,OAAOF,KAAP;EACD;EACD;AACF;AACA;;;EAGEH,SAAS,CAACM,SAAV,CAAoBC,QAApB,GAA+B,UAAUC,IAAV,EAAgB;IAC7C,IAAIC,MAAM,GAAG,KAAKC,UAAL,CAAgB,QAAhB,CAAb;IACA,OAAO7C,MAAM,CAAC2C,IAAI,CAACG,KAAN,EAAa1C,oBAAoB,CAACG,mCAAmC,CAACF,kBAAkB,CAAC,KAAK0C,aAAN,CAAnB,CAApC,CAApB,IAAqG3C,oBAAoB,CAAC4C,MAAvI,EAA+IJ,MAA/I,EAAuJ,KAAKC,UAAL,CAAgB,QAAhB,CAAvJ,CAAb;EACD,CAHD;;EAKAV,SAAS,CAACM,SAAV,CAAoBQ,iBAApB,GAAwC,UAAUN,IAAV,EAAgBO,GAAhB,EAAqBC,cAArB,EAAqC;IAC3E,IAAIC,KAAK,GAAG,KAAKP,UAAL,CAAgB,QAAhB,CAAZ;IACA,IAAIQ,IAAI,GAAG,KAAKR,UAAL,CAAgB,QAAhB,CAAX;IACA,OAAO5C,aAAa,CAAC0C,IAAD,EAAOO,GAAP,EAAYC,cAAZ,EAA4BE,IAA5B,EAAkCD,KAAlC,CAApB;EACD,CAJD;EAKA;AACF;AACA;;;EAGEjB,SAAS,CAACM,SAAV,CAAoBa,QAApB,GAA+B,YAAY;IACzC,IAAIC,QAAQ,GAAG,KAAKC,SAApB;IACA,IAAIC,MAAM,GAAG,KAAKC,OAAlB;IACA,IAAIC,KAAK,GAAG,EAAZ,CAHyC,CAGzB;;IAEhB,IAAI,CAACJ,QAAL,EAAe;MACb,OAAOI,KAAP;IACD;;IAEDA,KAAK,CAACC,IAAN,CAAW;MACTd,KAAK,EAAEW,MAAM,CAAC,CAAD,CADJ;MAETI,KAAK,EAAE;IAFE,CAAX;IAIA,IAAIjB,MAAM,GAAG,KAAKC,UAAL,CAAgB,QAAhB,CAAb;IACA,IAAIiB,UAAU,GAAGC,gBAAgB,CAAC,KAAKhB,aAAN,EAAqB,KAAKiB,eAA1B,EAA2CpB,MAA3C,EAAmDa,MAAnD,CAAjC;IACAE,KAAK,GAAGA,KAAK,CAACM,MAAN,CAAaH,UAAb,CAAR;IACAH,KAAK,CAACC,IAAN,CAAW;MACTd,KAAK,EAAEW,MAAM,CAAC,CAAD,CADJ;MAETI,KAAK,EAAE;IAFE,CAAX;IAIA,OAAOF,KAAP;EACD,CArBD;;EAuBAxB,SAAS,CAACM,SAAV,CAAoByB,cAApB,GAAqC,UAAUC,GAAV,EAAe;IAClD,IAAIV,MAAM,GAAG,KAAKC,OAAlB,CADkD,CACvB;;IAE3B,IAAID,MAAM,CAAC,CAAD,CAAN,KAAcA,MAAM,CAAC,CAAD,CAAxB,EAA6B;MAC3B;MACAA,MAAM,CAAC,CAAD,CAAN,IAAa3D,OAAb;MACA2D,MAAM,CAAC,CAAD,CAAN,IAAa3D,OAAb;IACD,CAPiD,CAOhD;;;IAGF,IAAI2D,MAAM,CAAC,CAAD,CAAN,KAAc,CAACW,QAAf,IAA2BX,MAAM,CAAC,CAAD,CAAN,KAAcW,QAA7C,EAAuD;MACrD,IAAIC,CAAC,GAAG,IAAIC,IAAJ,EAAR;MACAb,MAAM,CAAC,CAAD,CAAN,GAAY,CAAC,IAAIa,IAAJ,CAASD,CAAC,CAACE,WAAF,EAAT,EAA0BF,CAAC,CAACG,QAAF,EAA1B,EAAwCH,CAAC,CAACI,OAAF,EAAxC,CAAb;MACAhB,MAAM,CAAC,CAAD,CAAN,GAAYA,MAAM,CAAC,CAAD,CAAN,GAAY3D,OAAxB;IACD;;IAED,KAAK4E,aAAL,CAAmBP,GAAG,CAACQ,WAAvB,EAAoCR,GAAG,CAACS,WAAxC,EAAqDT,GAAG,CAACU,WAAzD;EACD,CAjBD;;EAmBA1C,SAAS,CAACM,SAAV,CAAoBiC,aAApB,GAAoC,UAAUI,aAAV,EAAyBF,WAAzB,EAAsCC,WAAtC,EAAmD;IACrFC,aAAa,GAAGA,aAAa,IAAI,EAAjC;IACA,IAAIrB,MAAM,GAAG,KAAKC,OAAlB;IACA,IAAIqB,IAAI,GAAGtB,MAAM,CAAC,CAAD,CAAN,GAAYA,MAAM,CAAC,CAAD,CAA7B;IACA,KAAKO,eAAL,GAAuBe,IAAI,GAAGD,aAA9B;;IAEA,IAAIF,WAAW,IAAI,IAAf,IAAuB,KAAKZ,eAAL,GAAuBY,WAAlD,EAA+D;MAC7D,KAAKZ,eAAL,GAAuBY,WAAvB;IACD;;IAED,IAAIC,WAAW,IAAI,IAAf,IAAuB,KAAKb,eAAL,GAAuBa,WAAlD,EAA+D;MAC7D,KAAKb,eAAL,GAAuBa,WAAvB;IACD;;IAED,IAAIG,iBAAiB,GAAGC,cAAc,CAACC,MAAvC;IACA,IAAIhC,GAAG,GAAGiC,IAAI,CAACC,GAAL,CAASvD,MAAM,CAACoD,cAAD,EAAiB,KAAKjB,eAAtB,EAAuC,CAAvC,EAA0CgB,iBAA1C,CAAf,EAA6EA,iBAAiB,GAAG,CAAjG,CAAV,CAfqF,CAe0B;;IAE/G,KAAKxB,SAAL,GAAiByB,cAAc,CAAC/B,GAAD,CAAd,CAAoB,CAApB,CAAjB,CAjBqF,CAiB5C;IACzC;;IAEA,KAAKH,aAAL,GAAqBkC,cAAc,CAACE,IAAI,CAACE,GAAL,CAASnC,GAAG,GAAG,CAAf,EAAkB,CAAlB,CAAD,CAAd,CAAqC,CAArC,CAArB;EACD,CArBD;;EAuBAf,SAAS,CAACM,SAAV,CAAoB6C,KAApB,GAA4B,UAAUC,GAAV,EAAe;IACzC;IACA,OAAO5D,QAAQ,CAAC4D,GAAD,CAAR,GAAgBA,GAAhB,GAAsB,CAAC7F,UAAU,CAAC8F,SAAX,CAAqBD,GAArB,CAA9B;EACD,CAHD;;EAKApD,SAAS,CAACM,SAAV,CAAoBgD,OAApB,GAA8B,UAAUF,GAAV,EAAe;IAC3C,OAAOjE,WAAW,CAACmE,OAAZ,CAAoB,KAAKH,KAAL,CAAWC,GAAX,CAApB,EAAqC,KAAK7B,OAA1C,CAAP;EACD,CAFD;;EAIAvB,SAAS,CAACM,SAAV,CAAoBiD,SAApB,GAAgC,UAAUH,GAAV,EAAe;IAC7C,OAAOjE,WAAW,CAACoE,SAAZ,CAAsB,KAAKJ,KAAL,CAAWC,GAAX,CAAtB,EAAuC,KAAK7B,OAA5C,CAAP;EACD,CAFD;;EAIAvB,SAAS,CAACM,SAAV,CAAoBkD,KAApB,GAA4B,UAAUJ,GAAV,EAAe;IACzC,OAAOjE,WAAW,CAACqE,KAAZ,CAAkBJ,GAAlB,EAAuB,KAAK7B,OAA5B,CAAP;EACD,CAFD;;EAIAvB,SAAS,CAACK,IAAV,GAAiB,MAAjB;EACA,OAAOL,SAAP;AACD,CAjHD,CAiHEZ,aAjHF,CAFA;AAoHA;AACA;AACA;AACA;AACA;AACA;;;AAGA,IAAI0D,cAAc,GAAG,CAAC;AACtB,CAAC,QAAD,EAAWtF,UAAX,CADqB,EACG,CAAC,QAAD,EAAWC,UAAX,CADH,EAC2B,CAAC,MAAD,EAASC,QAAT,CAD3B,EAC+C,CAAC,aAAD,EAAgBA,QAAQ,GAAG,CAA3B,CAD/C,EAC8E,CAAC,UAAD,EAAaA,QAAQ,GAAG,EAAxB,CAD9E,EAC2G,CAAC,KAAD,EAAQC,OAAO,GAAG,GAAlB,CAD3G,EACmI,CAAC,WAAD,EAAcA,OAAO,GAAG,GAAxB,CADnI,EACiK,CAAC,MAAD,EAASA,OAAO,GAAG,CAAnB,CADjK,EACwL,CAAC,OAAD,EAAUA,OAAO,GAAG,EAApB,CADxL,EACiN,CAAC,SAAD,EAAYA,OAAO,GAAG,EAAtB,CADjN,EAC4O,CAAC,WAAD,EAAcC,QAAQ,GAAG,CAAzB,CAD5O,EACyQ,CAAC,MAAD,EAASA,QAAT,CADzQ,CAC4R;AAD5R,CAArB;;AAIA,SAAS6F,eAAT,CAAyBC,IAAzB,EAA+BC,MAA/B,EAAuCC,MAAvC,EAA+C3C,KAA/C,EAAsD;EACpD,IAAI4C,KAAK,GAAGtG,UAAU,CAAC8F,SAAX,CAAqBM,MAArB,CAAZ;EACA,IAAIG,KAAK,GAAGvG,UAAU,CAAC8F,SAAX,CAAqBO,MAArB,CAAZ;;EAEA,IAAIG,MAAM,GAAG,UAAUL,IAAV,EAAgB;IAC3B,OAAO3F,YAAY,CAAC8F,KAAD,EAAQH,IAAR,EAAczC,KAAd,CAAZ,KAAqClD,YAAY,CAAC+F,KAAD,EAAQJ,IAAR,EAAczC,KAAd,CAAxD;EACD,CAFD;;EAIA,IAAI+C,UAAU,GAAG,YAAY;IAC3B,OAAOD,MAAM,CAAC,MAAD,CAAb;EACD,CAFD,CARoD,CAUjD;EACH;;;EAGA,IAAIE,WAAW,GAAG,YAAY;IAC5B,OAAOD,UAAU,MAAMD,MAAM,CAAC,OAAD,CAA7B;EACD,CAFD;;EAIA,IAAIG,SAAS,GAAG,YAAY;IAC1B,OAAOD,WAAW,MAAMF,MAAM,CAAC,KAAD,CAA9B;EACD,CAFD,CAlBoD,CAoBjD;;;EAGH,IAAII,UAAU,GAAG,YAAY;IAC3B,OAAOD,SAAS,MAAMH,MAAM,CAAC,MAAD,CAA5B;EACD,CAFD;;EAIA,IAAIK,YAAY,GAAG,YAAY;IAC7B,OAAOD,UAAU,MAAMJ,MAAM,CAAC,QAAD,CAA7B;EACD,CAFD;;EAIA,IAAIM,YAAY,GAAG,YAAY;IAC7B,OAAOD,YAAY,MAAML,MAAM,CAAC,QAAD,CAA/B;EACD,CAFD;;EAIA,IAAIO,iBAAiB,GAAG,YAAY;IAClC,OAAOD,YAAY,MAAMN,MAAM,CAAC,aAAD,CAA/B;EACD,CAFD;;EAIA,QAAQL,IAAR;IACE,KAAK,MAAL;MACE,OAAOM,UAAU,EAAjB;;IAEF,KAAK,OAAL;MACE,OAAOC,WAAW,EAAlB;;IAEF,KAAK,KAAL;MACE,OAAOC,SAAS,EAAhB;;IAEF,KAAK,MAAL;MACE,OAAOC,UAAU,EAAjB;;IAEF,KAAK,QAAL;MACE,OAAOC,YAAY,EAAnB;;IAEF,KAAK,QAAL;MACE,OAAOC,YAAY,EAAnB;;IAEF,KAAK,aAAL;MACE,OAAOC,iBAAiB,EAAxB;EApBJ;AAsBD,C,CAAC;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,SAASC,eAAT,CAAyBC,cAAzB,EAAyCC,WAAzC,EAAsD;EACpDD,cAAc,IAAI7G,OAAlB;EACA,OAAO6G,cAAc,GAAG,EAAjB,GAAsB,EAAtB,CAAyB;EAAzB,EACLA,cAAc,GAAG,GAAjB,GAAuB,CAAvB,CAAyB;EAAzB,EACAA,cAAc,GAAG,GAAjB,GAAuB,CAAvB,GAA2BA,cAAc,GAAG,GAAjB,GAAuB,CAAvB,GAA2B,CAFxD;AAGD;;AAED,SAASE,gBAAT,CAA0BF,cAA1B,EAA0C;EACxC,IAAIG,gBAAgB,GAAG,KAAKhH,OAA5B;EACA6G,cAAc,IAAIG,gBAAlB;EACA,OAAOH,cAAc,GAAG,CAAjB,GAAqB,CAArB,GAAyBA,cAAc,GAAG,CAAjB,GAAqB,CAArB,GAAyBA,cAAc,GAAG,CAAjB,GAAqB,CAArB,GAAyB,CAAlF;AACD;;AAED,SAASI,eAAT,CAAyBJ,cAAzB,EAAyC;EACvCA,cAAc,IAAI9G,QAAlB;EACA,OAAO8G,cAAc,GAAG,EAAjB,GAAsB,EAAtB,GAA2BA,cAAc,GAAG,CAAjB,GAAqB,CAArB,GAAyBA,cAAc,GAAG,GAAjB,GAAuB,CAAvB,GAA2BA,cAAc,GAAG,CAAjB,GAAqB,CAArB,GAAyB,CAA/G;AACD;;AAED,SAASK,4BAAT,CAAsCL,cAAtC,EAAsDM,SAAtD,EAAiE;EAC/DN,cAAc,IAAIM,SAAS,GAAGrH,UAAH,GAAgBD,UAA3C;EACA,OAAOgH,cAAc,GAAG,EAAjB,GAAsB,EAAtB,GAA2BA,cAAc,GAAG,EAAjB,GAAsB,EAAtB,GAA2BA,cAAc,GAAG,EAAjB,GAAsB,EAAtB,GAA2BA,cAAc,GAAG,EAAjB,GAAsB,EAAtB,GAA2BA,cAAc,GAAG,CAAjB,GAAqB,CAArB,GAAyBA,cAAc,GAAG,CAAjB,GAAqB,CAArB,GAAyB,CAArK;AACD;;AAED,SAASO,uBAAT,CAAiCP,cAAjC,EAAiD;EAC/C,OAAOjH,UAAU,CAACyH,IAAX,CAAgBR,cAAhB,EAAgC,IAAhC,CAAP;AACD;;AAED,SAASS,uBAAT,CAAiCC,IAAjC,EAAuCC,QAAvC,EAAiDlE,KAAjD,EAAwD;EACtD,IAAImE,OAAO,GAAG,IAAIjD,IAAJ,CAAS+C,IAAT,CAAd;;EAEA,QAAQhH,kBAAkB,CAACiH,QAAD,CAA1B;IACE,KAAK,MAAL;IACA,KAAK,OAAL;MACEC,OAAO,CAAC9G,eAAe,CAAC2C,KAAD,CAAhB,CAAP,CAAgC,CAAhC;;IAEF,KAAK,KAAL;MACEmE,OAAO,CAAC5G,cAAc,CAACyC,KAAD,CAAf,CAAP,CAA+B,CAA/B;;IAEF,KAAK,MAAL;MACEmE,OAAO,CAAC1G,eAAe,CAACuC,KAAD,CAAhB,CAAP,CAAgC,CAAhC;;IAEF,KAAK,QAAL;MACEmE,OAAO,CAACzG,iBAAiB,CAACsC,KAAD,CAAlB,CAAP,CAAkC,CAAlC;;IAEF,KAAK,QAAL;MACEmE,OAAO,CAACxG,iBAAiB,CAACqC,KAAD,CAAlB,CAAP,CAAkC,CAAlC;MACAmE,OAAO,CAACvG,sBAAsB,CAACoC,KAAD,CAAvB,CAAP,CAAuC,CAAvC;EAhBJ;;EAmBA,OAAOmE,OAAO,CAACC,OAAR,EAAP;AACD;;AAED,SAASzD,gBAAT,CAA0B0D,cAA1B,EAA0Cd,cAA1C,EAA0DvD,KAA1D,EAAiEK,MAAjE,EAAyE;EACvE,IAAIiE,SAAS,GAAG,KAAhB;EACA,IAAIC,SAAS,GAAGxH,SAAhB;EACA,IAAIyH,IAAI,GAAG,CAAX;;EAEA,SAASC,cAAT,CAAwBtE,QAAxB,EAAkCuE,YAAlC,EAAgDC,YAAhD,EAA8DC,aAA9D,EAA6EC,aAA7E,EAA4FC,MAA5F,EAAoGC,GAApG,EAAyG;IACvG,IAAId,IAAI,GAAG,IAAI/C,IAAJ,CAASwD,YAAT,CAAX;IACA,IAAIM,QAAQ,GAAGN,YAAf;IACA,IAAIzD,CAAC,GAAGgD,IAAI,CAACW,aAAD,CAAJ,EAAR,CAHuG,CAGxE;IAC/B;IACA;;IAEA,OAAOI,QAAQ,GAAGL,YAAX,IAA2BK,QAAQ,IAAI3E,MAAM,CAAC,CAAD,CAApD,EAAyD;MACvD0E,GAAG,CAACvE,IAAJ,CAAS;QACPd,KAAK,EAAEsF;MADA,CAAT;MAGA/D,CAAC,IAAId,QAAL;MACA8D,IAAI,CAACY,aAAD,CAAJ,CAAoB5D,CAApB;MACA+D,QAAQ,GAAGf,IAAI,CAACG,OAAL,EAAX;IACD,CAdsG,CAcrG;;;IAGFW,GAAG,CAACvE,IAAJ,CAAS;MACPd,KAAK,EAAEsF,QADA;MAEPC,MAAM,EAAE;IAFD,CAAT;EAID;;EAED,SAASC,aAAT,CAAuBhB,QAAvB,EAAiCiB,cAAjC,EAAiDC,UAAjD,EAA6D;IAC3D,IAAIC,aAAa,GAAG,EAApB;IACA,IAAIC,YAAY,GAAG,CAACH,cAAc,CAACrD,MAAnC;;IAEA,IAAIU,eAAe,CAACvF,kBAAkB,CAACiH,QAAD,CAAnB,EAA+B7D,MAAM,CAAC,CAAD,CAArC,EAA0CA,MAAM,CAAC,CAAD,CAAhD,EAAqDL,KAArD,CAAnB,EAAgF;MAC9E;IACD;;IAED,IAAIsF,YAAJ,EAAkB;MAChBH,cAAc,GAAG,CAAC;QAChB;QACAzF,KAAK,EAAEsE,uBAAuB,CAAC,IAAI9C,IAAJ,CAASb,MAAM,CAAC,CAAD,CAAf,CAAD,EAAsB6D,QAAtB,EAAgClE,KAAhC;MAFd,CAAD,EAGd;QACDN,KAAK,EAAEW,MAAM,CAAC,CAAD;MADZ,CAHc,CAAjB;IAMD;;IAED,KAAK,IAAIkF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGJ,cAAc,CAACrD,MAAf,GAAwB,CAA5C,EAA+CyD,CAAC,EAAhD,EAAoD;MAClD,IAAIC,SAAS,GAAGL,cAAc,CAACI,CAAD,CAAd,CAAkB7F,KAAlC;MACA,IAAI+F,OAAO,GAAGN,cAAc,CAACI,CAAC,GAAG,CAAL,CAAd,CAAsB7F,KAApC;;MAEA,IAAI8F,SAAS,KAAKC,OAAlB,EAA2B;QACzB;MACD;;MAED,IAAItF,QAAQ,GAAG,KAAK,CAApB;MACA,IAAIuF,UAAU,GAAG,KAAK,CAAtB;MACA,IAAIC,UAAU,GAAG,KAAK,CAAtB;MACA,IAAIb,MAAM,GAAG,KAAb;;MAEA,QAAQZ,QAAR;QACE,KAAK,MAAL;UACE/D,QAAQ,GAAG4B,IAAI,CAACE,GAAL,CAAS,CAAT,EAAYF,IAAI,CAAC6D,KAAL,CAAWrC,cAAc,GAAG7G,OAAjB,GAA2B,GAAtC,CAAZ,CAAX;UACAgJ,UAAU,GAAGtI,kBAAkB,CAAC4C,KAAD,CAA/B;UACA2F,UAAU,GAAGrI,kBAAkB,CAAC0C,KAAD,CAA/B;UACA;;QAEF,KAAK,WAAL;QACA,KAAK,SAAL;QACA,KAAK,OAAL;UACEG,QAAQ,GAAGsD,gBAAgB,CAACF,cAAD,CAA3B;UACAmC,UAAU,GAAG7H,eAAe,CAACmC,KAAD,CAA5B;UACA2F,UAAU,GAAGtI,eAAe,CAAC2C,KAAD,CAA5B;UACA;;QAEF,KAAK,MAAL,CAfF,CAee;;QAEb,KAAK,WAAL;QACA,KAAK,KAAL;UACEG,QAAQ,GAAGmD,eAAe,CAACC,cAAD,EAAiB,EAAjB,CAA1B,CADF,CACkD;;UAEhDmC,UAAU,GAAG5H,cAAc,CAACkC,KAAD,CAA3B;UACA2F,UAAU,GAAGpI,cAAc,CAACyC,KAAD,CAA3B;UACA8E,MAAM,GAAG,IAAT;UACA;;QAEF,KAAK,UAAL;QACA,KAAK,aAAL;QACA,KAAK,MAAL;UACE3E,QAAQ,GAAGwD,eAAe,CAACJ,cAAD,CAA1B;UACAmC,UAAU,GAAGlI,eAAe,CAACwC,KAAD,CAA5B;UACA2F,UAAU,GAAGlI,eAAe,CAACuC,KAAD,CAA5B;UACA;;QAEF,KAAK,QAAL;UACEG,QAAQ,GAAGyD,4BAA4B,CAACL,cAAD,EAAiB,IAAjB,CAAvC;UACAmC,UAAU,GAAG3H,iBAAiB,CAACiC,KAAD,CAA9B;UACA2F,UAAU,GAAGjI,iBAAiB,CAACsC,KAAD,CAA9B;UACA;;QAEF,KAAK,QAAL;UACEG,QAAQ,GAAGyD,4BAA4B,CAACL,cAAD,EAAiB,KAAjB,CAAvC;UACAmC,UAAU,GAAG1H,iBAAiB,CAACgC,KAAD,CAA9B;UACA2F,UAAU,GAAGhI,iBAAiB,CAACqC,KAAD,CAA9B;UACA;;QAEF,KAAK,aAAL;UACEG,QAAQ,GAAG2D,uBAAuB,CAACP,cAAD,CAAlC;UACAmC,UAAU,GAAGzH,sBAAsB,CAAC+B,KAAD,CAAnC;UACA2F,UAAU,GAAG/H,sBAAsB,CAACoC,KAAD,CAAnC;UACA;MAlDJ;;MAqDAyE,cAAc,CAACtE,QAAD,EAAWqF,SAAX,EAAsBC,OAAtB,EAA+BC,UAA/B,EAA2CC,UAA3C,EAAuDb,MAAvD,EAA+DO,aAA/D,CAAd;;MAEA,IAAInB,QAAQ,KAAK,MAAb,IAAuBkB,UAAU,CAACtD,MAAX,GAAoB,CAA3C,IAAgDyD,CAAC,KAAK,CAA1D,EAA6D;QAC3D;QACAH,UAAU,CAACS,OAAX,CAAmB;UACjBnG,KAAK,EAAE0F,UAAU,CAAC,CAAD,CAAV,CAAc1F,KAAd,GAAsBS;QADZ,CAAnB;MAGD;IACF;;IAED,KAAK,IAAIoF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,aAAa,CAACvD,MAAlC,EAA0CyD,CAAC,EAA3C,EAA+C;MAC7CH,UAAU,CAAC5E,IAAX,CAAgB6E,aAAa,CAACE,CAAD,CAA7B;IACD,CA/F0D,CA+FzD;;;IAGF,OAAOF,aAAP;EACD;;EAED,IAAIS,WAAW,GAAG,EAAlB;EACA,IAAIC,iBAAiB,GAAG,EAAxB;EACA,IAAIC,SAAS,GAAG,CAAhB;EACA,IAAIC,kBAAkB,GAAG,CAAzB;;EAEA,KAAK,IAAIV,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGhB,SAAS,CAACzC,MAAd,IAAwB0C,IAAI,KAAKF,SAAjD,EAA4D,EAAEiB,CAA9D,EAAiE;IAC/D,IAAIW,eAAe,GAAGjJ,kBAAkB,CAACsH,SAAS,CAACgB,CAAD,CAAV,CAAxC;;IAEA,IAAI,CAACrI,iBAAiB,CAACqH,SAAS,CAACgB,CAAD,CAAV,CAAtB,EAAsC;MACpC;MACA;IACD;;IAEDL,aAAa,CAACX,SAAS,CAACgB,CAAD,CAAV,EAAeO,WAAW,CAACA,WAAW,CAAChE,MAAZ,GAAqB,CAAtB,CAAX,IAAuC,EAAtD,EAA0DiE,iBAA1D,CAAb;IACA,IAAII,mBAAmB,GAAG5B,SAAS,CAACgB,CAAC,GAAG,CAAL,CAAT,GAAmBtI,kBAAkB,CAACsH,SAAS,CAACgB,CAAC,GAAG,CAAL,CAAV,CAArC,GAA0D,IAApF;;IAEA,IAAIW,eAAe,KAAKC,mBAAxB,EAA6C;MAC3C,IAAIJ,iBAAiB,CAACjE,MAAtB,EAA8B;QAC5BmE,kBAAkB,GAAGD,SAArB,CAD4B,CACI;;QAEhCD,iBAAiB,CAACK,IAAlB,CAAuB,UAAU1H,CAAV,EAAa2H,CAAb,EAAgB;UACrC,OAAO3H,CAAC,CAACgB,KAAF,GAAU2G,CAAC,CAAC3G,KAAnB;QACD,CAFD;QAGA,IAAI4G,0BAA0B,GAAG,EAAjC;;QAEA,KAAK,IAAIC,GAAG,GAAG,CAAf,EAAkBA,GAAG,GAAGR,iBAAiB,CAACjE,MAA1C,EAAkD,EAAEyE,GAApD,EAAyD;UACvD,IAAIC,SAAS,GAAGT,iBAAiB,CAACQ,GAAD,CAAjB,CAAuB7G,KAAvC;;UAEA,IAAI6G,GAAG,KAAK,CAAR,IAAaR,iBAAiB,CAACQ,GAAG,GAAG,CAAP,CAAjB,CAA2B7G,KAA3B,KAAqC8G,SAAtD,EAAiE;YAC/DF,0BAA0B,CAAC9F,IAA3B,CAAgCuF,iBAAiB,CAACQ,GAAD,CAAjD;;YAEA,IAAIC,SAAS,IAAInG,MAAM,CAAC,CAAD,CAAnB,IAA0BmG,SAAS,IAAInG,MAAM,CAAC,CAAD,CAAjD,EAAsD;cACpD2F,SAAS;YACV;UACF;QACF;;QAED,IAAIS,aAAa,GAAG,CAACpG,MAAM,CAAC,CAAD,CAAN,GAAYA,MAAM,CAAC,CAAD,CAAnB,IAA0BkD,cAA9C,CApB4B,CAoBkC;;QAE9D,IAAIyC,SAAS,GAAGS,aAAa,GAAG,GAA5B,IAAmCR,kBAAkB,GAAGQ,aAAa,GAAG,GAA5E,EAAiF;UAC/E;QACD,CAxB2B,CAwB1B;;;QAGFX,WAAW,CAACtF,IAAZ,CAAiB8F,0BAAjB;;QAEA,IAAIN,SAAS,GAAGS,aAAZ,IAA6BpC,cAAc,KAAKE,SAAS,CAACgB,CAAD,CAA7D,EAAkE;UAChE;QACD;MACF,CAjC0C,CAiCzC;;;MAGFQ,iBAAiB,GAAG,EAApB;IACD;EACF;;EAED,IAAIW,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAA7B,EAA2C;IACzC,IAAIpC,IAAI,IAAIF,SAAZ,EAAuB;MACrBjG,IAAI,CAAC,oBAAD,CAAJ;IACD;EACF;;EAED,IAAIwI,mBAAmB,GAAGvI,MAAM,CAACE,GAAG,CAACsH,WAAD,EAAc,UAAUV,UAAV,EAAsB;IACtE,OAAO9G,MAAM,CAAC8G,UAAD,EAAa,UAAU7F,IAAV,EAAgB;MACxC,OAAOA,IAAI,CAACG,KAAL,IAAcW,MAAM,CAAC,CAAD,CAApB,IAA2Bd,IAAI,CAACG,KAAL,IAAcW,MAAM,CAAC,CAAD,CAA/C,IAAsD,CAACd,IAAI,CAAC0F,MAAnE;IACD,CAFY,CAAb;EAGD,CAJmC,CAAJ,EAI5B,UAAUG,UAAV,EAAsB;IACxB,OAAOA,UAAU,CAACtD,MAAX,GAAoB,CAA3B;EACD,CAN+B,CAAhC;EAOA,IAAIvB,KAAK,GAAG,EAAZ;EACA,IAAIuG,QAAQ,GAAGD,mBAAmB,CAAC/E,MAApB,GAA6B,CAA5C;;EAEA,KAAK,IAAIyD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGsB,mBAAmB,CAAC/E,MAAxC,EAAgD,EAAEyD,CAAlD,EAAqD;IACnD,IAAIH,UAAU,GAAGyB,mBAAmB,CAACtB,CAAD,CAApC;;IAEA,KAAK,IAAIwB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG3B,UAAU,CAACtD,MAA/B,EAAuC,EAAEiF,CAAzC,EAA4C;MAC1CxG,KAAK,CAACC,IAAN,CAAW;QACTd,KAAK,EAAE0F,UAAU,CAAC2B,CAAD,CAAV,CAAcrH,KADZ;QAETe,KAAK,EAAEqG,QAAQ,GAAGvB;MAFT,CAAX;IAID;EACF;;EAEDhF,KAAK,CAAC6F,IAAN,CAAW,UAAU1H,CAAV,EAAa2H,CAAb,EAAgB;IACzB,OAAO3H,CAAC,CAACgB,KAAF,GAAU2G,CAAC,CAAC3G,KAAnB;EACD,CAFD,EApNuE,CAsNnE;;EAEJ,IAAIsH,MAAM,GAAG,EAAb;;EAEA,KAAK,IAAIzB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGhF,KAAK,CAACuB,MAA1B,EAAkC,EAAEyD,CAApC,EAAuC;IACrC,IAAIA,CAAC,KAAK,CAAN,IAAWhF,KAAK,CAACgF,CAAD,CAAL,CAAS7F,KAAT,KAAmBa,KAAK,CAACgF,CAAC,GAAG,CAAL,CAAL,CAAa7F,KAA/C,EAAsD;MACpDsH,MAAM,CAACxG,IAAP,CAAYD,KAAK,CAACgF,CAAD,CAAjB;IACD;EACF;;EAED,OAAOyB,MAAP;AACD;;AAED5I,KAAK,CAAC6I,aAAN,CAAoBlI,SAApB;AACA,eAAeA,SAAf"},"metadata":{},"sourceType":"module"}